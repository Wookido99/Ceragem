[Logging] Writing output to logs/hparam_search/20251028-042251_run007_lstm_sl20_es20_lr0.001_bs32.log
Using CUDA device 7: NVIDIA RTX A6000
Train files: 60 | Validation files: 20 | Test files: 20
Using feature columns: ['C4-M1', 'F4-M1', 'O2-M1', 'Fp1-O2', 'T3 - CZ', 'CZ - T4', 'E1', 'E2', 'ECG', 'PTAF', 'FLOW', 'ABDOMEN', 'SAO2', 'BVP', 'ACC_X', 'ACC_Y', 'ACC_Z', 'TEMP', 'EDA', 'HR', 'IBI']
preprocess-dreamt:   0%|          | 0/60 [00:00<?, ?file/s]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S025_PSG_df_updated.csv ---
preprocess-dreamt:   2%|1         | 1/60 [00:09<09:46,  9.94s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S010_PSG_df_updated.csv ---
preprocess-dreamt:   3%|3         | 2/60 [00:19<09:26,  9.77s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S013_PSG_df_updated.csv ---
preprocess-dreamt:   5%|5         | 3/60 [00:28<08:44,  9.20s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S009_PSG_df_updated.csv ---
preprocess-dreamt:   7%|6         | 4/60 [00:36<08:21,  8.95s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S051_PSG_df_updated.csv ---
preprocess-dreamt:   8%|8         | 5/60 [00:44<07:56,  8.67s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S015_PSG_df_updated.csv ---
preprocess-dreamt:  10%|#         | 6/60 [00:57<08:58,  9.97s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S003_PSG_df_updated.csv ---
preprocess-dreamt:  12%|#1        | 7/60 [01:06<08:30,  9.64s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S095_PSG_df_updated.csv ---
preprocess-dreamt:  13%|#3        | 8/60 [01:15<08:13,  9.48s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S098_PSG_df_updated.csv ---
preprocess-dreamt:  15%|#5        | 9/60 [01:24<07:56,  9.34s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S057_PSG_df_updated.csv ---
preprocess-dreamt:  17%|#6        | 10/60 [01:33<07:42,  9.25s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S018_PSG_df_updated.csv ---
preprocess-dreamt:  18%|#8        | 11/60 [01:44<07:57,  9.74s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S067_PSG_df_updated.csv ---
preprocess-dreamt:  20%|##        | 12/60 [01:53<07:38,  9.56s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S055_PSG_df_updated.csv ---
preprocess-dreamt:  22%|##1       | 13/60 [02:02<07:14,  9.25s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S044_PSG_df_updated.csv ---
preprocess-dreamt:  23%|##3       | 14/60 [02:10<06:47,  8.86s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S084_PSG_df_updated.csv ---
preprocess-dreamt:  25%|##5       | 15/60 [02:19<06:42,  8.94s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S004_PSG_df_updated.csv ---
preprocess-dreamt:  27%|##6       | 16/60 [02:28<06:33,  8.95s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S050_PSG_df_updated.csv ---
preprocess-dreamt:  28%|##8       | 17/60 [02:36<06:13,  8.70s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S091_PSG_df_updated.csv ---
preprocess-dreamt:  30%|###       | 18/60 [02:45<06:15,  8.94s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S082_PSG_df_updated.csv ---
preprocess-dreamt:  32%|###1      | 19/60 [02:54<06:07,  8.97s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S070_PSG_df_updated.csv ---
preprocess-dreamt:  33%|###3      | 20/60 [03:03<05:58,  8.96s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S021_PSG_df_updated.csv ---
Skipping file due to preprocessing error: could not convert string to float: '2.6855878538185697e-069043259327077127e-06'
preprocess-dreamt:  35%|###5      | 21/60 [04:42<23:15, 35.77s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S008_PSG_df_updated.csv ---
preprocess-dreamt:  37%|###6      | 22/60 [04:51<17:39, 27.87s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S026_PSG_df_updated.csv ---
preprocess-dreamt:  38%|###8      | 23/60 [05:02<14:03, 22.81s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S012_PSG_df_updated.csv ---
preprocess-dreamt:  40%|####      | 24/60 [05:12<11:24, 19.03s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S063_PSG_df_updated.csv ---
preprocess-dreamt:  42%|####1     | 25/60 [05:21<09:16, 15.90s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S032_PSG_df_updated.csv ---
preprocess-dreamt:  43%|####3     | 26/60 [05:30<07:57, 14.03s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S024_PSG_df_updated.csv ---
preprocess-dreamt:  45%|####5     | 27/60 [05:41<07:08, 12.99s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S031_PSG_df_updated.csv ---
preprocess-dreamt:  47%|####6     | 28/60 [05:50<06:16, 11.78s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S087_PSG_df_updated.csv ---
preprocess-dreamt:  48%|####8     | 29/60 [05:58<05:34, 10.78s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S039_PSG_df_updated.csv ---
preprocess-dreamt:  50%|#####     | 30/60 [06:08<05:12, 10.43s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S097_PSG_df_updated.csv ---
preprocess-dreamt:  52%|#####1    | 31/60 [06:16<04:37,  9.56s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S085_PSG_df_updated.csv ---
preprocess-dreamt:  53%|#####3    | 32/60 [06:24<04:21,  9.33s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S046_PSG_df_updated.csv ---
preprocess-dreamt:  55%|#####5    | 33/60 [06:34<04:12,  9.34s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S103_PSG_df_updated.csv ---
preprocess-dreamt:  57%|#####6    | 34/60 [06:42<03:52,  8.96s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S090_PSG_df_updated.csv ---
preprocess-dreamt:  58%|#####8    | 35/60 [06:51<03:45,  9.00s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S030_PSG_df_updated.csv ---
preprocess-dreamt:  60%|######    | 36/60 [07:01<03:42,  9.29s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S036_PSG_df_updated.csv ---
preprocess-dreamt:  62%|######1   | 37/60 [07:13<03:50, 10.03s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S092_PSG_df_updated.csv ---
preprocess-dreamt:  63%|######3   | 38/60 [07:22<03:37,  9.88s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S047_PSG_df_updated.csv ---
preprocess-dreamt:  65%|######5   | 39/60 [07:31<03:23,  9.68s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S016_PSG_df_updated.csv ---
preprocess-dreamt:  67%|######6   | 40/60 [07:43<03:24, 10.24s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S088_PSG_df_updated.csv ---
preprocess-dreamt:  68%|######8   | 41/60 [07:53<03:13, 10.16s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S074_PSG_df_updated.csv ---
preprocess-dreamt:  70%|#######   | 42/60 [08:03<03:01, 10.08s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S006_PSG_df_updated.csv ---
preprocess-dreamt:  72%|#######1  | 43/60 [08:12<02:48,  9.90s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S022_PSG_df_updated.csv ---
preprocess-dreamt:  73%|#######3  | 44/60 [08:22<02:38,  9.88s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S017_PSG_df_updated.csv ---
preprocess-dreamt:  75%|#######5  | 45/60 [08:35<02:42, 10.81s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S023_PSG_df_updated.csv ---
preprocess-dreamt:  77%|#######6  | 46/60 [08:45<02:28, 10.58s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S033_PSG_df_updated.csv ---
preprocess-dreamt:  78%|#######8  | 47/60 [08:55<02:13, 10.28s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S080_PSG_df_updated.csv ---
preprocess-dreamt:  80%|########  | 48/60 [09:04<02:00, 10.02s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S061_PSG_df_updated.csv ---
preprocess-dreamt:  82%|########1 | 49/60 [09:14<01:49,  9.95s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S071_PSG_df_updated.csv ---
preprocess-dreamt:  83%|########3 | 50/60 [09:23<01:37,  9.77s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S077_PSG_df_updated.csv ---
preprocess-dreamt:  85%|########5 | 51/60 [09:31<01:21,  9.08s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S053_PSG_df_updated.csv ---
preprocess-dreamt:  87%|########6 | 52/60 [09:40<01:12,  9.08s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S073_PSG_df_updated.csv ---
preprocess-dreamt:  88%|########8 | 53/60 [09:49<01:04,  9.27s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S027_PSG_df_updated.csv ---
preprocess-dreamt:  90%|######### | 54/60 [10:00<00:57,  9.56s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S102_PSG_df_updated.csv ---
preprocess-dreamt:  92%|#########1| 55/60 [10:08<00:46,  9.26s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S049_PSG_df_updated.csv ---
preprocess-dreamt:  93%|#########3| 56/60 [10:18<00:37,  9.44s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S100_PSG_df_updated.csv ---
preprocess-dreamt:  95%|#########5| 57/60 [10:28<00:28,  9.48s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S002_PSG_df_updated.csv ---
preprocess-dreamt:  97%|#########6| 58/60 [10:37<00:18,  9.39s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S076_PSG_df_updated.csv ---
preprocess-dreamt:  98%|#########8| 59/60 [10:46<00:09,  9.37s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S037_PSG_df_updated.csv ---
preprocess-dreamt: 100%|##########| 60/60 [10:57<00:00,  9.68s/file]preprocess-dreamt: 100%|##########| 60/60 [10:57<00:00, 10.95s/file]
preprocess-dreamt:   0%|          | 0/20 [00:00<?, ?file/s]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S062_PSG_df_updated.csv ---
preprocess-dreamt:   5%|5         | 1/20 [00:07<02:21,  7.47s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S096_PSG_df_updated.csv ---
preprocess-dreamt:  10%|#         | 2/20 [00:16<02:33,  8.52s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S005_PSG_df_updated.csv ---
preprocess-dreamt:  15%|#5        | 3/20 [00:25<02:29,  8.81s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S099_PSG_df_updated.csv ---
preprocess-dreamt:  20%|##        | 4/20 [00:34<02:20,  8.77s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S059_PSG_df_updated.csv ---
preprocess-dreamt:  25%|##5       | 5/20 [00:43<02:13,  8.92s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S094_PSG_df_updated.csv ---
preprocess-dreamt:  30%|###       | 6/20 [00:52<02:06,  9.01s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S028_PSG_df_updated.csv ---
preprocess-dreamt:  35%|###5      | 7/20 [01:03<02:04,  9.58s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S043_PSG_df_updated.csv ---
preprocess-dreamt:  40%|####      | 8/20 [01:12<01:51,  9.33s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S058_PSG_df_updated.csv ---
preprocess-dreamt:  45%|####5     | 9/20 [01:21<01:40,  9.18s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S093_PSG_df_updated.csv ---
preprocess-dreamt:  50%|#####     | 10/20 [01:30<01:31,  9.13s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S079_PSG_df_updated.csv ---
preprocess-dreamt:  55%|#####5    | 11/20 [01:39<01:22,  9.12s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S075_PSG_df_updated.csv ---
preprocess-dreamt:  60%|######    | 12/20 [01:48<01:12,  9.06s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S064_PSG_df_updated.csv ---
preprocess-dreamt:  65%|######5   | 13/20 [01:57<01:04,  9.18s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S045_PSG_df_updated.csv ---
preprocess-dreamt:  70%|#######   | 14/20 [02:06<00:53,  8.98s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S011_PSG_df_updated.csv ---
preprocess-dreamt:  75%|#######5  | 15/20 [02:15<00:45,  9.14s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S086_PSG_df_updated.csv ---
preprocess-dreamt:  80%|########  | 16/20 [02:25<00:36,  9.13s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S042_PSG_df_updated.csv ---
preprocess-dreamt:  85%|########5 | 17/20 [02:32<00:25,  8.55s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S020_PSG_df_updated.csv ---
Skipping file due to preprocessing error: could not convert string to float: '-6.4942397192330.0003244678416113'
preprocess-dreamt:  90%|######### | 18/20 [02:40<00:16,  8.35s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S081_PSG_df_updated.csv ---
preprocess-dreamt:  95%|#########5| 19/20 [02:48<00:08,  8.30s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S072_PSG_df_updated.csv ---
preprocess-dreamt: 100%|##########| 20/20 [02:57<00:00,  8.48s/file]preprocess-dreamt: 100%|##########| 20/20 [02:57<00:00,  8.86s/file]
preprocess-dreamt:   0%|          | 0/20 [00:00<?, ?file/s]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S034_PSG_df_updated.csv ---
preprocess-dreamt:   5%|5         | 1/20 [00:07<02:30,  7.95s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S083_PSG_df_updated.csv ---
preprocess-dreamt:  10%|#         | 2/20 [00:14<02:12,  7.36s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S014_PSG_df_updated.csv ---
preprocess-dreamt:  15%|#5        | 3/20 [00:22<02:10,  7.69s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S089_PSG_df_updated.csv ---
preprocess-dreamt:  20%|##        | 4/20 [00:31<02:10,  8.18s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S038_PSG_df_updated.csv ---
preprocess-dreamt:  25%|##5       | 5/20 [00:41<02:10,  8.72s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S019_PSG_df_updated.csv ---
Skipping file due to preprocessing error: could not convert string to float: '--33.0'
preprocess-dreamt:  30%|###       | 6/20 [02:17<08:57, 38.41s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S068_PSG_df_updated.csv ---
preprocess-dreamt:  35%|###5      | 7/20 [02:26<06:14, 28.80s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S029_PSG_df_updated.csv ---
preprocess-dreamt:  40%|####      | 8/20 [02:37<04:36, 23.04s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S078_PSG_df_updated.csv ---
preprocess-dreamt:  45%|####5     | 9/20 [02:46<03:27, 18.82s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S048_PSG_df_updated.csv ---
preprocess-dreamt:  50%|#####     | 10/20 [02:55<02:37, 15.79s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S065_PSG_df_updated.csv ---
preprocess-dreamt:  55%|#####5    | 11/20 [03:05<02:04, 13.88s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S040_PSG_df_updated.csv ---
preprocess-dreamt:  60%|######    | 12/20 [03:15<01:41, 12.70s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S054_PSG_df_updated.csv ---
preprocess-dreamt:  65%|######5   | 13/20 [03:25<01:22, 11.83s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S066_PSG_df_updated.csv ---
preprocess-dreamt:  70%|#######   | 14/20 [03:34<01:05, 10.98s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S069_PSG_df_updated.csv ---
preprocess-dreamt:  75%|#######5  | 15/20 [03:44<00:53, 10.67s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S035_PSG_df_updated.csv ---
preprocess-dreamt:  80%|########  | 16/20 [03:53<00:41, 10.35s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S007_PSG_df_updated.csv ---
preprocess-dreamt:  85%|########5 | 17/20 [04:02<00:29,  9.94s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S056_PSG_df_updated.csv ---
preprocess-dreamt:  90%|######### | 18/20 [04:11<00:19,  9.60s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S101_PSG_df_updated.csv ---
preprocess-dreamt:  95%|#########5| 19/20 [04:21<00:09,  9.55s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S052_PSG_df_updated.csv ---
preprocess-dreamt: 100%|##########| 20/20 [04:29<00:00,  9.35s/file]preprocess-dreamt: 100%|##########| 20/20 [04:29<00:00, 13.50s/file]
Using 21 channels with 2000 samples per epoch.
ceragem:   0%|          | 0/10 [00:00<?, ?it/s]Epoch   1/10: train_loss=1.1081 | val_loss=1.4008 | train_acc=0.5804 | val_acc=0.4529 | val_macro_f1=0.2139
ceragem:  10%|#         | 1/10 [01:24<12:42, 84.72s/it]Epoch   2/10: train_loss=0.9276 | val_loss=1.5246 | train_acc=0.6544 | val_acc=0.4570 | val_macro_f1=0.2192
ceragem:  20%|##        | 2/10 [02:43<10:49, 81.21s/it]Epoch   3/10: train_loss=0.8460 | val_loss=1.5321 | train_acc=0.6897 | val_acc=0.4620 | val_macro_f1=0.2280
ceragem:  30%|###       | 3/10 [03:59<09:12, 78.94s/it]Epoch   4/10: train_loss=0.7893 | val_loss=1.5768 | train_acc=0.7134 | val_acc=0.4693 | val_macro_f1=0.2388
ceragem:  40%|####      | 4/10 [05:18<07:53, 78.87s/it]Epoch   5/10: train_loss=0.7561 | val_loss=1.6375 | train_acc=0.7274 | val_acc=0.4615 | val_macro_f1=0.2272
ceragem:  50%|#####     | 5/10 [06:45<06:49, 81.99s/it]Epoch   6/10: train_loss=0.7254 | val_loss=1.6592 | train_acc=0.7367 | val_acc=0.4688 | val_macro_f1=0.2396
ceragem:  60%|######    | 6/10 [08:19<05:43, 85.86s/it]Epoch   7/10: train_loss=0.7043 | val_loss=1.7261 | train_acc=0.7465 | val_acc=0.4633 | val_macro_f1=0.2376
ceragem:  70%|#######   | 7/10 [11:16<05:47, 115.78s/it]Epoch   8/10: train_loss=0.6859 | val_loss=1.7583 | train_acc=0.7540 | val_acc=0.4666 | val_macro_f1=0.2420
ceragem:  80%|########  | 8/10 [13:56<04:19, 129.68s/it]Epoch   9/10: train_loss=0.6691 | val_loss=1.7760 | train_acc=0.7600 | val_acc=0.4609 | val_macro_f1=0.2301
ceragem:  90%|######### | 9/10 [16:04<02:09, 129.17s/it]Epoch  10/10: train_loss=0.6612 | val_loss=1.8182 | train_acc=0.7613 | val_acc=0.4725 | val_macro_f1=0.2370
ceragem: 100%|##########| 10/10 [18:07<00:00, 127.42s/it]ceragem: 100%|##########| 10/10 [18:07<00:00, 108.78s/it]

Summary (loss: train/val, acc: train/val):
  - Epoch   1: loss 1.1081/1.4008 | acc 0.5804/0.4529 | val_macro_f1 0.2139
  - Epoch   2: loss 0.9276/1.5246 | acc 0.6544/0.4570 | val_macro_f1 0.2192
  - Epoch   3: loss 0.8460/1.5321 | acc 0.6897/0.4620 | val_macro_f1 0.2280
  - Epoch   4: loss 0.7893/1.5768 | acc 0.7134/0.4693 | val_macro_f1 0.2388
  - Epoch   5: loss 0.7561/1.6375 | acc 0.7274/0.4615 | val_macro_f1 0.2272
  - Epoch   6: loss 0.7254/1.6592 | acc 0.7367/0.4688 | val_macro_f1 0.2396
  - Epoch   7: loss 0.7043/1.7261 | acc 0.7465/0.4633 | val_macro_f1 0.2376
  - Epoch   8: loss 0.6859/1.7583 | acc 0.7540/0.4666 | val_macro_f1 0.2420
  - Epoch   9: loss 0.6691/1.7760 | acc 0.7600/0.4609 | val_macro_f1 0.2301
  - Epoch  10: loss 0.6612/1.8182 | acc 0.7613/0.4725 | val_macro_f1 0.2370

Elapsed training time: 1087.76 seconds

Loaded best model from epoch 8 based on validation macro F1 0.2420.

Final validation metrics: loss=1.7583 | acc=0.4666 | macro_f1=0.2420

Validation metrics:
  Accuracy           : 0.4666
  Balanced Accuracy  : 0.2523
  Macro F1           : 0.2420
  Weighted F1        : 0.4288
  Cohen's Kappa      : 0.1174
  Matthews Corrcoef  : 0.1220

  Per-class metrics (precision | recall | f1 | support):
      W (0): 0.4292 | 0.3627 | 0.3932 | 5167
     N1 (1): 0.1359 | 0.0214 | 0.0370 | 2756
     N2 (2): 0.5466 | 0.7097 | 0.6175 | 10735
     N3 (3): 0.0075 | 0.0025 | 0.0038 | 395
      R (4): 0.1526 | 0.1652 | 0.1587 | 2198

  Confusion matrix (rows=true, cols=pred):
[[1874  146 2748   12  387]
 [ 567   59 1876   33  221]
 [1532  196 7619   74 1314]
 [  20   12  269    1   93]
 [ 373   21 1428   13  363]]

  Classification report:
              precision    recall  f1-score   support

           W       0.43      0.36      0.39      5167
          N1       0.14      0.02      0.04      2756
          N2       0.55      0.71      0.62     10735
          N3       0.01      0.00      0.00       395
           R       0.15      0.17      0.16      2198

    accuracy                           0.47     21251
   macro avg       0.25      0.25      0.24     21251
weighted avg       0.41      0.47      0.43     21251


Test metrics: loss=1.8559 | acc=0.4349 | macro_f1=0.2445

Test metrics:
  Accuracy           : 0.4349
  Balanced Accuracy  : 0.2468
  Macro F1           : 0.2445
  Weighted F1        : 0.4066
  Cohen's Kappa      : 0.0795
  Matthews Corrcoef  : 0.0813

  Per-class metrics (precision | recall | f1 | support):
      W (0): 0.3611 | 0.3297 | 0.3447 | 5138
     N1 (1): 0.1576 | 0.0443 | 0.0692 | 2414
     N2 (2): 0.5321 | 0.6540 | 0.5868 | 11509
     N3 (3): 0.2053 | 0.0349 | 0.0597 | 888
      R (4): 0.1542 | 0.1710 | 0.1622 | 2591

  Confusion matrix (rows=true, cols=pred):
[[1694  224 2758   13  449]
 [ 444  107 1550   28  285]
 [2074  249 7527   78 1581]
 [  95   13  634   31  115]
 [ 384   86 1677    1  443]]

  Classification report:
              precision    recall  f1-score   support

           W       0.36      0.33      0.34      5138
          N1       0.16      0.04      0.07      2414
          N2       0.53      0.65      0.59     11509
          N3       0.21      0.03      0.06       888
           R       0.15      0.17      0.16      2591

    accuracy                           0.43     22540
   macro avg       0.28      0.25      0.24     22540
weighted avg       0.40      0.43      0.41     22540



# --- Captured stdout ---
[Logging] Writing output to logs/hparam_search/20251028-042251_run007_lstm_sl20_es20_lr0.001_bs32.log
Using CUDA device 7: NVIDIA RTX A6000
Train files: 60 | Validation files: 20 | Test files: 20
Using feature columns: ['C4-M1', 'F4-M1', 'O2-M1', 'Fp1-O2', 'T3 - CZ', 'CZ - T4', 'E1', 'E2', 'ECG', 'PTAF', 'FLOW', 'ABDOMEN', 'SAO2', 'BVP', 'ACC_X', 'ACC_Y', 'ACC_Z', 'TEMP', 'EDA', 'HR', 'IBI']

preprocess-dreamt:   0%|          | 0/60 [00:00<?, ?file/s]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S025_PSG_df_updated.csv ---

preprocess-dreamt:   2%|1         | 1/60 [00:09<09:46,  9.94s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S010_PSG_df_updated.csv ---

preprocess-dreamt:   3%|3         | 2/60 [00:19<09:26,  9.77s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S013_PSG_df_updated.csv ---

preprocess-dreamt:   5%|5         | 3/60 [00:28<08:44,  9.20s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S009_PSG_df_updated.csv ---

preprocess-dreamt:   7%|6         | 4/60 [00:36<08:21,  8.95s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S051_PSG_df_updated.csv ---

preprocess-dreamt:   8%|8         | 5/60 [00:44<07:56,  8.67s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S015_PSG_df_updated.csv ---

preprocess-dreamt:  10%|#         | 6/60 [00:57<08:58,  9.97s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S003_PSG_df_updated.csv ---

preprocess-dreamt:  12%|#1        | 7/60 [01:06<08:30,  9.64s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S095_PSG_df_updated.csv ---

preprocess-dreamt:  13%|#3        | 8/60 [01:15<08:13,  9.48s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S098_PSG_df_updated.csv ---

preprocess-dreamt:  15%|#5        | 9/60 [01:24<07:56,  9.34s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S057_PSG_df_updated.csv ---

preprocess-dreamt:  17%|#6        | 10/60 [01:33<07:42,  9.25s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S018_PSG_df_updated.csv ---

preprocess-dreamt:  18%|#8        | 11/60 [01:44<07:57,  9.74s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S067_PSG_df_updated.csv ---

preprocess-dreamt:  20%|##        | 12/60 [01:53<07:38,  9.56s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S055_PSG_df_updated.csv ---

preprocess-dreamt:  22%|##1       | 13/60 [02:02<07:14,  9.25s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S044_PSG_df_updated.csv ---

preprocess-dreamt:  23%|##3       | 14/60 [02:10<06:47,  8.86s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S084_PSG_df_updated.csv ---

preprocess-dreamt:  25%|##5       | 15/60 [02:19<06:42,  8.94s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S004_PSG_df_updated.csv ---

preprocess-dreamt:  27%|##6       | 16/60 [02:28<06:33,  8.95s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S050_PSG_df_updated.csv ---

preprocess-dreamt:  28%|##8       | 17/60 [02:36<06:13,  8.70s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S091_PSG_df_updated.csv ---

preprocess-dreamt:  30%|###       | 18/60 [02:45<06:15,  8.94s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S082_PSG_df_updated.csv ---

preprocess-dreamt:  32%|###1      | 19/60 [02:54<06:07,  8.97s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S070_PSG_df_updated.csv ---

preprocess-dreamt:  33%|###3      | 20/60 [03:03<05:58,  8.96s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S021_PSG_df_updated.csv ---
Skipping file due to preprocessing error: could not convert string to float: '2.6855878538185697e-069043259327077127e-06'

preprocess-dreamt:  35%|###5      | 21/60 [04:42<23:15, 35.77s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S008_PSG_df_updated.csv ---

preprocess-dreamt:  37%|###6      | 22/60 [04:51<17:39, 27.87s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S026_PSG_df_updated.csv ---

preprocess-dreamt:  38%|###8      | 23/60 [05:02<14:03, 22.81s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S012_PSG_df_updated.csv ---

preprocess-dreamt:  40%|####      | 24/60 [05:12<11:24, 19.03s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S063_PSG_df_updated.csv ---

preprocess-dreamt:  42%|####1     | 25/60 [05:21<09:16, 15.90s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S032_PSG_df_updated.csv ---

preprocess-dreamt:  43%|####3     | 26/60 [05:30<07:57, 14.03s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S024_PSG_df_updated.csv ---

preprocess-dreamt:  45%|####5     | 27/60 [05:41<07:08, 12.99s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S031_PSG_df_updated.csv ---

preprocess-dreamt:  47%|####6     | 28/60 [05:50<06:16, 11.78s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S087_PSG_df_updated.csv ---

preprocess-dreamt:  48%|####8     | 29/60 [05:58<05:34, 10.78s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S039_PSG_df_updated.csv ---

preprocess-dreamt:  50%|#####     | 30/60 [06:08<05:12, 10.43s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S097_PSG_df_updated.csv ---

preprocess-dreamt:  52%|#####1    | 31/60 [06:16<04:37,  9.56s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S085_PSG_df_updated.csv ---

preprocess-dreamt:  53%|#####3    | 32/60 [06:24<04:21,  9.33s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S046_PSG_df_updated.csv ---

preprocess-dreamt:  55%|#####5    | 33/60 [06:34<04:12,  9.34s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S103_PSG_df_updated.csv ---

preprocess-dreamt:  57%|#####6    | 34/60 [06:42<03:52,  8.96s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S090_PSG_df_updated.csv ---

preprocess-dreamt:  58%|#####8    | 35/60 [06:51<03:45,  9.00s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S030_PSG_df_updated.csv ---

preprocess-dreamt:  60%|######    | 36/60 [07:01<03:42,  9.29s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S036_PSG_df_updated.csv ---

preprocess-dreamt:  62%|######1   | 37/60 [07:13<03:50, 10.03s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S092_PSG_df_updated.csv ---

preprocess-dreamt:  63%|######3   | 38/60 [07:22<03:37,  9.88s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S047_PSG_df_updated.csv ---

preprocess-dreamt:  65%|######5   | 39/60 [07:31<03:23,  9.68s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S016_PSG_df_updated.csv ---

preprocess-dreamt:  67%|######6   | 40/60 [07:43<03:24, 10.24s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S088_PSG_df_updated.csv ---

preprocess-dreamt:  68%|######8   | 41/60 [07:53<03:13, 10.16s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S074_PSG_df_updated.csv ---

preprocess-dreamt:  70%|#######   | 42/60 [08:03<03:01, 10.08s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S006_PSG_df_updated.csv ---

preprocess-dreamt:  72%|#######1  | 43/60 [08:12<02:48,  9.90s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S022_PSG_df_updated.csv ---

preprocess-dreamt:  73%|#######3  | 44/60 [08:22<02:38,  9.88s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S017_PSG_df_updated.csv ---

preprocess-dreamt:  75%|#######5  | 45/60 [08:35<02:42, 10.81s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S023_PSG_df_updated.csv ---

preprocess-dreamt:  77%|#######6  | 46/60 [08:45<02:28, 10.58s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S033_PSG_df_updated.csv ---

preprocess-dreamt:  78%|#######8  | 47/60 [08:55<02:13, 10.28s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S080_PSG_df_updated.csv ---

preprocess-dreamt:  80%|########  | 48/60 [09:04<02:00, 10.02s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S061_PSG_df_updated.csv ---

preprocess-dreamt:  82%|########1 | 49/60 [09:14<01:49,  9.95s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S071_PSG_df_updated.csv ---

preprocess-dreamt:  83%|########3 | 50/60 [09:23<01:37,  9.77s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S077_PSG_df_updated.csv ---

preprocess-dreamt:  85%|########5 | 51/60 [09:31<01:21,  9.08s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S053_PSG_df_updated.csv ---

preprocess-dreamt:  87%|########6 | 52/60 [09:40<01:12,  9.08s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S073_PSG_df_updated.csv ---

preprocess-dreamt:  88%|########8 | 53/60 [09:49<01:04,  9.27s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S027_PSG_df_updated.csv ---

preprocess-dreamt:  90%|######### | 54/60 [10:00<00:57,  9.56s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S102_PSG_df_updated.csv ---

preprocess-dreamt:  92%|#########1| 55/60 [10:08<00:46,  9.26s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S049_PSG_df_updated.csv ---

preprocess-dreamt:  93%|#########3| 56/60 [10:18<00:37,  9.44s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S100_PSG_df_updated.csv ---

preprocess-dreamt:  95%|#########5| 57/60 [10:28<00:28,  9.48s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S002_PSG_df_updated.csv ---

preprocess-dreamt:  97%|#########6| 58/60 [10:37<00:18,  9.39s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S076_PSG_df_updated.csv ---

preprocess-dreamt:  98%|#########8| 59/60 [10:46<00:09,  9.37s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S037_PSG_df_updated.csv ---

preprocess-dreamt: 100%|##########| 60/60 [10:57<00:00,  9.68s/file]
preprocess-dreamt: 100%|##########| 60/60 [10:57<00:00, 10.95s/file]

preprocess-dreamt:   0%|          | 0/20 [00:00<?, ?file/s]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S062_PSG_df_updated.csv ---

preprocess-dreamt:   5%|5         | 1/20 [00:07<02:21,  7.47s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S096_PSG_df_updated.csv ---

preprocess-dreamt:  10%|#         | 2/20 [00:16<02:33,  8.52s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S005_PSG_df_updated.csv ---

preprocess-dreamt:  15%|#5        | 3/20 [00:25<02:29,  8.81s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S099_PSG_df_updated.csv ---

preprocess-dreamt:  20%|##        | 4/20 [00:34<02:20,  8.77s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S059_PSG_df_updated.csv ---

preprocess-dreamt:  25%|##5       | 5/20 [00:43<02:13,  8.92s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S094_PSG_df_updated.csv ---

preprocess-dreamt:  30%|###       | 6/20 [00:52<02:06,  9.01s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S028_PSG_df_updated.csv ---

preprocess-dreamt:  35%|###5      | 7/20 [01:03<02:04,  9.58s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S043_PSG_df_updated.csv ---

preprocess-dreamt:  40%|####      | 8/20 [01:12<01:51,  9.33s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S058_PSG_df_updated.csv ---

preprocess-dreamt:  45%|####5     | 9/20 [01:21<01:40,  9.18s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S093_PSG_df_updated.csv ---

preprocess-dreamt:  50%|#####     | 10/20 [01:30<01:31,  9.13s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S079_PSG_df_updated.csv ---

preprocess-dreamt:  55%|#####5    | 11/20 [01:39<01:22,  9.12s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S075_PSG_df_updated.csv ---

preprocess-dreamt:  60%|######    | 12/20 [01:48<01:12,  9.06s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S064_PSG_df_updated.csv ---

preprocess-dreamt:  65%|######5   | 13/20 [01:57<01:04,  9.18s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S045_PSG_df_updated.csv ---

preprocess-dreamt:  70%|#######   | 14/20 [02:06<00:53,  8.98s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S011_PSG_df_updated.csv ---

preprocess-dreamt:  75%|#######5  | 15/20 [02:15<00:45,  9.14s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S086_PSG_df_updated.csv ---

preprocess-dreamt:  80%|########  | 16/20 [02:25<00:36,  9.13s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S042_PSG_df_updated.csv ---

preprocess-dreamt:  85%|########5 | 17/20 [02:32<00:25,  8.55s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S020_PSG_df_updated.csv ---
Skipping file due to preprocessing error: could not convert string to float: '-6.4942397192330.0003244678416113'

preprocess-dreamt:  90%|######### | 18/20 [02:40<00:16,  8.35s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S081_PSG_df_updated.csv ---

preprocess-dreamt:  95%|#########5| 19/20 [02:48<00:08,  8.30s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S072_PSG_df_updated.csv ---

preprocess-dreamt: 100%|##########| 20/20 [02:57<00:00,  8.48s/file]
preprocess-dreamt: 100%|##########| 20/20 [02:57<00:00,  8.86s/file]

preprocess-dreamt:   0%|          | 0/20 [00:00<?, ?file/s]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S034_PSG_df_updated.csv ---

preprocess-dreamt:   5%|5         | 1/20 [00:07<02:30,  7.95s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S083_PSG_df_updated.csv ---

preprocess-dreamt:  10%|#         | 2/20 [00:14<02:12,  7.36s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S014_PSG_df_updated.csv ---

preprocess-dreamt:  15%|#5        | 3/20 [00:22<02:10,  7.69s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S089_PSG_df_updated.csv ---

preprocess-dreamt:  20%|##        | 4/20 [00:31<02:10,  8.18s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S038_PSG_df_updated.csv ---

preprocess-dreamt:  25%|##5       | 5/20 [00:41<02:10,  8.72s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S019_PSG_df_updated.csv ---
Skipping file due to preprocessing error: could not convert string to float: '--33.0'

preprocess-dreamt:  30%|###       | 6/20 [02:17<08:57, 38.41s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S068_PSG_df_updated.csv ---

preprocess-dreamt:  35%|###5      | 7/20 [02:26<06:14, 28.80s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S029_PSG_df_updated.csv ---

preprocess-dreamt:  40%|####      | 8/20 [02:37<04:36, 23.04s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S078_PSG_df_updated.csv ---

preprocess-dreamt:  45%|####5     | 9/20 [02:46<03:27, 18.82s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S048_PSG_df_updated.csv ---

preprocess-dreamt:  50%|#####     | 10/20 [02:55<02:37, 15.79s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S065_PSG_df_updated.csv ---

preprocess-dreamt:  55%|#####5    | 11/20 [03:05<02:04, 13.88s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S040_PSG_df_updated.csv ---

preprocess-dreamt:  60%|######    | 12/20 [03:15<01:41, 12.70s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S054_PSG_df_updated.csv ---

preprocess-dreamt:  65%|######5   | 13/20 [03:25<01:22, 11.83s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S066_PSG_df_updated.csv ---

preprocess-dreamt:  70%|#######   | 14/20 [03:34<01:05, 10.98s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S069_PSG_df_updated.csv ---

preprocess-dreamt:  75%|#######5  | 15/20 [03:44<00:53, 10.67s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S035_PSG_df_updated.csv ---

preprocess-dreamt:  80%|########  | 16/20 [03:53<00:41, 10.35s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S007_PSG_df_updated.csv ---

preprocess-dreamt:  85%|########5 | 17/20 [04:02<00:29,  9.94s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S056_PSG_df_updated.csv ---

preprocess-dreamt:  90%|######### | 18/20 [04:11<00:19,  9.60s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S101_PSG_df_updated.csv ---

preprocess-dreamt:  95%|#########5| 19/20 [04:21<00:09,  9.55s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S052_PSG_df_updated.csv ---

preprocess-dreamt: 100%|##########| 20/20 [04:29<00:00,  9.35s/file]
preprocess-dreamt: 100%|##########| 20/20 [04:29<00:00, 13.50s/file]
Using 21 channels with 2000 samples per epoch.

ceragem:   0%|          | 0/10 [00:00<?, ?it/s]Epoch   1/10: train_loss=1.1081 | val_loss=1.4008 | train_acc=0.5804 | val_acc=0.4529 | val_macro_f1=0.2139

ceragem:  10%|#         | 1/10 [01:24<12:42, 84.72s/it]Epoch   2/10: train_loss=0.9276 | val_loss=1.5246 | train_acc=0.6544 | val_acc=0.4570 | val_macro_f1=0.2192

ceragem:  20%|##        | 2/10 [02:43<10:49, 81.21s/it]Epoch   3/10: train_loss=0.8460 | val_loss=1.5321 | train_acc=0.6897 | val_acc=0.4620 | val_macro_f1=0.2280

ceragem:  30%|###       | 3/10 [03:59<09:12, 78.94s/it]Epoch   4/10: train_loss=0.7893 | val_loss=1.5768 | train_acc=0.7134 | val_acc=0.4693 | val_macro_f1=0.2388

ceragem:  40%|####      | 4/10 [05:18<07:53, 78.87s/it]Epoch   5/10: train_loss=0.7561 | val_loss=1.6375 | train_acc=0.7274 | val_acc=0.4615 | val_macro_f1=0.2272

ceragem:  50%|#####     | 5/10 [06:45<06:49, 81.99s/it]Epoch   6/10: train_loss=0.7254 | val_loss=1.6592 | train_acc=0.7367 | val_acc=0.4688 | val_macro_f1=0.2396

ceragem:  60%|######    | 6/10 [08:19<05:43, 85.86s/it]Epoch   7/10: train_loss=0.7043 | val_loss=1.7261 | train_acc=0.7465 | val_acc=0.4633 | val_macro_f1=0.2376

ceragem:  70%|#######   | 7/10 [11:16<05:47, 115.78s/it]Epoch   8/10: train_loss=0.6859 | val_loss=1.7583 | train_acc=0.7540 | val_acc=0.4666 | val_macro_f1=0.2420

ceragem:  80%|########  | 8/10 [13:56<04:19, 129.68s/it]Epoch   9/10: train_loss=0.6691 | val_loss=1.7760 | train_acc=0.7600 | val_acc=0.4609 | val_macro_f1=0.2301

ceragem:  90%|######### | 9/10 [16:04<02:09, 129.17s/it]Epoch  10/10: train_loss=0.6612 | val_loss=1.8182 | train_acc=0.7613 | val_acc=0.4725 | val_macro_f1=0.2370

ceragem: 100%|##########| 10/10 [18:07<00:00, 127.42s/it]
ceragem: 100%|##########| 10/10 [18:07<00:00, 108.78s/it]

Summary (loss: train/val, acc: train/val):
  - Epoch   1: loss 1.1081/1.4008 | acc 0.5804/0.4529 | val_macro_f1 0.2139
  - Epoch   2: loss 0.9276/1.5246 | acc 0.6544/0.4570 | val_macro_f1 0.2192
  - Epoch   3: loss 0.8460/1.5321 | acc 0.6897/0.4620 | val_macro_f1 0.2280
  - Epoch   4: loss 0.7893/1.5768 | acc 0.7134/0.4693 | val_macro_f1 0.2388
  - Epoch   5: loss 0.7561/1.6375 | acc 0.7274/0.4615 | val_macro_f1 0.2272
  - Epoch   6: loss 0.7254/1.6592 | acc 0.7367/0.4688 | val_macro_f1 0.2396
  - Epoch   7: loss 0.7043/1.7261 | acc 0.7465/0.4633 | val_macro_f1 0.2376
  - Epoch   8: loss 0.6859/1.7583 | acc 0.7540/0.4666 | val_macro_f1 0.2420
  - Epoch   9: loss 0.6691/1.7760 | acc 0.7600/0.4609 | val_macro_f1 0.2301
  - Epoch  10: loss 0.6612/1.8182 | acc 0.7613/0.4725 | val_macro_f1 0.2370

Elapsed training time: 1087.76 seconds

Loaded best model from epoch 8 based on validation macro F1 0.2420.

Final validation metrics: loss=1.7583 | acc=0.4666 | macro_f1=0.2420

Validation metrics:
  Accuracy           : 0.4666
  Balanced Accuracy  : 0.2523
  Macro F1           : 0.2420
  Weighted F1        : 0.4288
  Cohen's Kappa      : 0.1174
  Matthews Corrcoef  : 0.1220

  Per-class metrics (precision | recall | f1 | support):
      W (0): 0.4292 | 0.3627 | 0.3932 | 5167
     N1 (1): 0.1359 | 0.0214 | 0.0370 | 2756
     N2 (2): 0.5466 | 0.7097 | 0.6175 | 10735
     N3 (3): 0.0075 | 0.0025 | 0.0038 | 395
      R (4): 0.1526 | 0.1652 | 0.1587 | 2198

  Confusion matrix (rows=true, cols=pred):
[[1874  146 2748   12  387]
 [ 567   59 1876   33  221]
 [1532  196 7619   74 1314]
 [  20   12  269    1   93]
 [ 373   21 1428   13  363]]

  Classification report:
              precision    recall  f1-score   support

           W       0.43      0.36      0.39      5167
          N1       0.14      0.02      0.04      2756
          N2       0.55      0.71      0.62     10735
          N3       0.01      0.00      0.00       395
           R       0.15      0.17      0.16      2198

    accuracy                           0.47     21251
   macro avg       0.25      0.25      0.24     21251
weighted avg       0.41      0.47      0.43     21251


Test metrics: loss=1.8559 | acc=0.4349 | macro_f1=0.2445

Test metrics:
  Accuracy           : 0.4349
  Balanced Accuracy  : 0.2468
  Macro F1           : 0.2445
  Weighted F1        : 0.4066
  Cohen's Kappa      : 0.0795
  Matthews Corrcoef  : 0.0813

  Per-class metrics (precision | recall | f1 | support):
      W (0): 0.3611 | 0.3297 | 0.3447 | 5138
     N1 (1): 0.1576 | 0.0443 | 0.0692 | 2414
     N2 (2): 0.5321 | 0.6540 | 0.5868 | 11509
     N3 (3): 0.2053 | 0.0349 | 0.0597 | 888
      R (4): 0.1542 | 0.1710 | 0.1622 | 2591

  Confusion matrix (rows=true, cols=pred):
[[1694  224 2758   13  449]
 [ 444  107 1550   28  285]
 [2074  249 7527   78 1581]
 [  95   13  634   31  115]
 [ 384   86 1677    1  443]]

  Classification report:
              precision    recall  f1-score   support

           W       0.36      0.33      0.34      5138
          N1       0.16      0.04      0.07      2414
          N2       0.53      0.65      0.59     11509
          N3       0.21      0.03      0.06       888
           R       0.15      0.17      0.16      2591

    accuracy                           0.43     22540
   macro avg       0.28      0.25      0.24     22540
weighted avg       0.40      0.43      0.41     22540

