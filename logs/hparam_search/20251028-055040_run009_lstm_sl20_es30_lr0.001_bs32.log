[Logging] Writing output to logs/hparam_search/20251028-055040_run009_lstm_sl20_es30_lr0.001_bs32.log
Using CUDA device 7: NVIDIA RTX A6000
Train files: 60 | Validation files: 20 | Test files: 20
Using feature columns: ['C4-M1', 'F4-M1', 'O2-M1', 'Fp1-O2', 'T3 - CZ', 'CZ - T4', 'E1', 'E2', 'ECG', 'PTAF', 'FLOW', 'ABDOMEN', 'SAO2', 'BVP', 'ACC_X', 'ACC_Y', 'ACC_Z', 'TEMP', 'EDA', 'HR', 'IBI']
preprocess-dreamt:   0%|          | 0/60 [00:00<?, ?file/s]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S025_PSG_df_updated.csv ---
preprocess-dreamt:   2%|1         | 1/60 [00:12<11:50, 12.03s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S010_PSG_df_updated.csv ---
preprocess-dreamt:   3%|3         | 2/60 [00:22<10:56, 11.32s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S013_PSG_df_updated.csv ---
preprocess-dreamt:   5%|5         | 3/60 [00:32<10:13, 10.76s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S009_PSG_df_updated.csv ---
preprocess-dreamt:   7%|6         | 4/60 [00:42<09:34, 10.26s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S051_PSG_df_updated.csv ---
preprocess-dreamt:   8%|8         | 5/60 [00:51<08:51,  9.66s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S015_PSG_df_updated.csv ---
preprocess-dreamt:  10%|#         | 6/60 [01:06<10:19, 11.47s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S003_PSG_df_updated.csv ---
preprocess-dreamt:  12%|#1        | 7/60 [01:17<10:01, 11.35s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S095_PSG_df_updated.csv ---
preprocess-dreamt:  13%|#3        | 8/60 [01:26<09:17, 10.72s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S098_PSG_df_updated.csv ---
preprocess-dreamt:  15%|#5        | 9/60 [01:37<09:15, 10.89s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S057_PSG_df_updated.csv ---
preprocess-dreamt:  17%|#6        | 10/60 [01:47<08:48, 10.57s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S018_PSG_df_updated.csv ---
preprocess-dreamt:  18%|#8        | 11/60 [02:00<09:19, 11.41s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S067_PSG_df_updated.csv ---
preprocess-dreamt:  20%|##        | 12/60 [02:10<08:44, 10.92s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S055_PSG_df_updated.csv ---
preprocess-dreamt:  22%|##1       | 13/60 [02:19<08:09, 10.41s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S044_PSG_df_updated.csv ---
preprocess-dreamt:  23%|##3       | 14/60 [02:29<07:42, 10.06s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S084_PSG_df_updated.csv ---
preprocess-dreamt:  25%|##5       | 15/60 [02:40<07:45, 10.35s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S004_PSG_df_updated.csv ---
preprocess-dreamt:  27%|##6       | 16/60 [02:51<07:52, 10.73s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S050_PSG_df_updated.csv ---
preprocess-dreamt:  28%|##8       | 17/60 [03:02<07:37, 10.63s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S091_PSG_df_updated.csv ---
preprocess-dreamt:  30%|###       | 18/60 [03:13<07:33, 10.80s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S082_PSG_df_updated.csv ---
preprocess-dreamt:  32%|###1      | 19/60 [03:23<07:11, 10.52s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S070_PSG_df_updated.csv ---
preprocess-dreamt:  33%|###3      | 20/60 [03:32<06:48, 10.21s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S021_PSG_df_updated.csv ---
Skipping file due to preprocessing error: could not convert string to float: '2.6855878538185697e-069043259327077127e-06'
preprocess-dreamt:  35%|###5      | 21/60 [05:16<24:52, 38.26s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S008_PSG_df_updated.csv ---
preprocess-dreamt:  37%|###6      | 22/60 [05:27<19:04, 30.12s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S026_PSG_df_updated.csv ---
preprocess-dreamt:  38%|###8      | 23/60 [05:41<15:32, 25.21s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S012_PSG_df_updated.csv ---
preprocess-dreamt:  40%|####      | 24/60 [05:53<12:45, 21.28s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S063_PSG_df_updated.csv ---
preprocess-dreamt:  42%|####1     | 25/60 [06:04<10:34, 18.12s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S032_PSG_df_updated.csv ---
preprocess-dreamt:  43%|####3     | 26/60 [06:21<10:03, 17.74s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S024_PSG_df_updated.csv ---
preprocess-dreamt:  45%|####5     | 27/60 [06:42<10:19, 18.77s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S031_PSG_df_updated.csv ---
preprocess-dreamt:  47%|####6     | 28/60 [07:01<10:09, 19.05s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S087_PSG_df_updated.csv ---
preprocess-dreamt:  48%|####8     | 29/60 [07:11<08:22, 16.21s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S039_PSG_df_updated.csv ---
preprocess-dreamt:  50%|#####     | 30/60 [07:23<07:27, 14.92s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S097_PSG_df_updated.csv ---
preprocess-dreamt:  52%|#####1    | 31/60 [07:34<06:40, 13.80s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S085_PSG_df_updated.csv ---
preprocess-dreamt:  53%|#####3    | 32/60 [07:46<06:06, 13.09s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S046_PSG_df_updated.csv ---
preprocess-dreamt:  55%|#####5    | 33/60 [07:58<05:46, 12.84s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S103_PSG_df_updated.csv ---
preprocess-dreamt:  57%|#####6    | 34/60 [08:10<05:27, 12.58s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S090_PSG_df_updated.csv ---
preprocess-dreamt:  58%|#####8    | 35/60 [08:22<05:09, 12.37s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S030_PSG_df_updated.csv ---
preprocess-dreamt:  60%|######    | 36/60 [08:36<05:08, 12.85s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S036_PSG_df_updated.csv ---
preprocess-dreamt:  62%|######1   | 37/60 [08:52<05:20, 13.93s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S092_PSG_df_updated.csv ---
preprocess-dreamt:  63%|######3   | 38/60 [09:06<05:05, 13.88s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S047_PSG_df_updated.csv ---
preprocess-dreamt:  65%|######5   | 39/60 [09:19<04:45, 13.61s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S016_PSG_df_updated.csv ---
preprocess-dreamt:  67%|######6   | 40/60 [09:33<04:37, 13.86s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S088_PSG_df_updated.csv ---
preprocess-dreamt:  68%|######8   | 41/60 [09:44<04:07, 13.02s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S074_PSG_df_updated.csv ---
preprocess-dreamt:  70%|#######   | 42/60 [09:55<03:44, 12.45s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S006_PSG_df_updated.csv ---
preprocess-dreamt:  72%|#######1  | 43/60 [10:06<03:24, 12.03s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S022_PSG_df_updated.csv ---
preprocess-dreamt:  73%|#######3  | 44/60 [10:18<03:10, 11.92s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S017_PSG_df_updated.csv ---
preprocess-dreamt:  75%|#######5  | 45/60 [10:33<03:13, 12.93s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S023_PSG_df_updated.csv ---
preprocess-dreamt:  77%|#######6  | 46/60 [10:45<02:56, 12.59s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S033_PSG_df_updated.csv ---
preprocess-dreamt:  78%|#######8  | 47/60 [10:57<02:39, 12.27s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S080_PSG_df_updated.csv ---
preprocess-dreamt:  80%|########  | 48/60 [11:08<02:23, 11.95s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S061_PSG_df_updated.csv ---
preprocess-dreamt:  82%|########1 | 49/60 [11:20<02:11, 11.97s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S071_PSG_df_updated.csv ---
preprocess-dreamt:  83%|########3 | 50/60 [11:31<01:57, 11.75s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S077_PSG_df_updated.csv ---
preprocess-dreamt:  85%|########5 | 51/60 [11:40<01:38, 10.91s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S053_PSG_df_updated.csv ---
preprocess-dreamt:  87%|########6 | 52/60 [11:51<01:27, 10.99s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S073_PSG_df_updated.csv ---
preprocess-dreamt:  88%|########8 | 53/60 [12:03<01:18, 11.19s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S027_PSG_df_updated.csv ---
preprocess-dreamt:  90%|######### | 54/60 [12:18<01:14, 12.34s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S102_PSG_df_updated.csv ---
preprocess-dreamt:  92%|#########1| 55/60 [12:30<01:01, 12.34s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S049_PSG_df_updated.csv ---
preprocess-dreamt:  93%|#########3| 56/60 [12:42<00:48, 12.21s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S100_PSG_df_updated.csv ---
preprocess-dreamt:  95%|#########5| 57/60 [12:56<00:38, 12.67s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S002_PSG_df_updated.csv ---
preprocess-dreamt:  97%|#########6| 58/60 [13:08<00:25, 12.54s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S076_PSG_df_updated.csv ---
preprocess-dreamt:  98%|#########8| 59/60 [13:20<00:12, 12.27s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S037_PSG_df_updated.csv ---
preprocess-dreamt: 100%|##########| 60/60 [13:33<00:00, 12.62s/file]preprocess-dreamt: 100%|##########| 60/60 [13:33<00:00, 13.56s/file]
preprocess-dreamt:   0%|          | 0/20 [00:00<?, ?file/s]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S062_PSG_df_updated.csv ---
preprocess-dreamt:   5%|5         | 1/20 [00:07<02:17,  7.25s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S096_PSG_df_updated.csv ---
preprocess-dreamt:  10%|#         | 2/20 [00:16<02:28,  8.27s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S005_PSG_df_updated.csv ---
preprocess-dreamt:  15%|#5        | 3/20 [00:25<02:25,  8.56s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S099_PSG_df_updated.csv ---
preprocess-dreamt:  20%|##        | 4/20 [00:33<02:17,  8.59s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S059_PSG_df_updated.csv ---
preprocess-dreamt:  25%|##5       | 5/20 [00:43<02:12,  8.86s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S094_PSG_df_updated.csv ---
preprocess-dreamt:  30%|###       | 6/20 [00:52<02:07,  9.10s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S028_PSG_df_updated.csv ---
preprocess-dreamt:  35%|###5      | 7/20 [01:03<02:07,  9.81s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S043_PSG_df_updated.csv ---
preprocess-dreamt:  40%|####      | 8/20 [01:13<01:56,  9.72s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S058_PSG_df_updated.csv ---
preprocess-dreamt:  45%|####5     | 9/20 [01:23<01:47,  9.77s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S093_PSG_df_updated.csv ---
preprocess-dreamt:  50%|#####     | 10/20 [01:33<01:38,  9.89s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S079_PSG_df_updated.csv ---
preprocess-dreamt:  55%|#####5    | 11/20 [01:43<01:29,  9.95s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S075_PSG_df_updated.csv ---
preprocess-dreamt:  60%|######    | 12/20 [01:53<01:18,  9.83s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S064_PSG_df_updated.csv ---
preprocess-dreamt:  65%|######5   | 13/20 [02:03<01:09,  9.87s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S045_PSG_df_updated.csv ---
preprocess-dreamt:  70%|#######   | 14/20 [02:12<00:57,  9.60s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S011_PSG_df_updated.csv ---
preprocess-dreamt:  75%|#######5  | 15/20 [02:22<00:49,  9.92s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S086_PSG_df_updated.csv ---
preprocess-dreamt:  80%|########  | 16/20 [02:33<00:40, 10.15s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S042_PSG_df_updated.csv ---
preprocess-dreamt:  85%|########5 | 17/20 [02:41<00:28,  9.39s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S020_PSG_df_updated.csv ---
Skipping file due to preprocessing error: could not convert string to float: '-6.4942397192330.0003244678416113'
preprocess-dreamt:  90%|######### | 18/20 [02:50<00:18,  9.45s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S081_PSG_df_updated.csv ---
preprocess-dreamt:  95%|#########5| 19/20 [03:00<00:09,  9.49s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S072_PSG_df_updated.csv ---
preprocess-dreamt: 100%|##########| 20/20 [03:09<00:00,  9.43s/file]preprocess-dreamt: 100%|##########| 20/20 [03:09<00:00,  9.48s/file]
preprocess-dreamt:   0%|          | 0/20 [00:00<?, ?file/s]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S034_PSG_df_updated.csv ---
preprocess-dreamt:   5%|5         | 1/20 [00:08<02:46,  8.74s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S083_PSG_df_updated.csv ---
preprocess-dreamt:  10%|#         | 2/20 [00:16<02:25,  8.10s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S014_PSG_df_updated.csv ---
preprocess-dreamt:  15%|#5        | 3/20 [00:26<02:30,  8.87s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S089_PSG_df_updated.csv ---
preprocess-dreamt:  20%|##        | 4/20 [00:36<02:28,  9.30s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S038_PSG_df_updated.csv ---
preprocess-dreamt:  25%|##5       | 5/20 [00:47<02:28,  9.87s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S019_PSG_df_updated.csv ---
Skipping file due to preprocessing error: could not convert string to float: '--33.0'
preprocess-dreamt:  30%|###       | 6/20 [02:23<09:10, 39.30s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S068_PSG_df_updated.csv ---
preprocess-dreamt:  35%|###5      | 7/20 [02:32<06:23, 29.53s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S029_PSG_df_updated.csv ---
preprocess-dreamt:  40%|####      | 8/20 [02:45<04:50, 24.18s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S078_PSG_df_updated.csv ---
preprocess-dreamt:  45%|####5     | 9/20 [02:55<03:37, 19.81s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S048_PSG_df_updated.csv ---
preprocess-dreamt:  50%|#####     | 10/20 [03:06<02:48, 16.85s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S065_PSG_df_updated.csv ---
preprocess-dreamt:  55%|#####5    | 11/20 [03:16<02:13, 14.86s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S040_PSG_df_updated.csv ---
preprocess-dreamt:  60%|######    | 12/20 [03:27<01:49, 13.69s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S054_PSG_df_updated.csv ---
preprocess-dreamt:  65%|######5   | 13/20 [03:38<01:29, 12.77s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S066_PSG_df_updated.csv ---
preprocess-dreamt:  70%|#######   | 14/20 [03:47<01:11, 11.87s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S069_PSG_df_updated.csv ---
preprocess-dreamt:  75%|#######5  | 15/20 [03:58<00:58, 11.66s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S035_PSG_df_updated.csv ---
preprocess-dreamt:  80%|########  | 16/20 [04:09<00:45, 11.36s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S007_PSG_df_updated.csv ---
preprocess-dreamt:  85%|########5 | 17/20 [04:19<00:32, 10.79s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S056_PSG_df_updated.csv ---
preprocess-dreamt:  90%|######### | 18/20 [04:28<00:20, 10.40s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S101_PSG_df_updated.csv ---
preprocess-dreamt:  95%|#########5| 19/20 [04:38<00:10, 10.24s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S052_PSG_df_updated.csv ---
preprocess-dreamt: 100%|##########| 20/20 [04:47<00:00,  9.99s/file]preprocess-dreamt: 100%|##########| 20/20 [04:47<00:00, 14.39s/file]
Using 21 channels with 3000 samples per epoch.
ceragem:   0%|          | 0/10 [00:00<?, ?it/s]Epoch   1/10: train_loss=1.1563 | val_loss=1.2706 | train_acc=0.5607 | val_acc=0.5020 | val_macro_f1=0.2141
ceragem:  10%|#         | 1/10 [01:14<11:14, 74.95s/it]Epoch   2/10: train_loss=1.0041 | val_loss=1.3858 | train_acc=0.6256 | val_acc=0.4857 | val_macro_f1=0.2297
ceragem:  20%|##        | 2/10 [02:23<09:29, 71.16s/it]Epoch   3/10: train_loss=0.9173 | val_loss=1.4753 | train_acc=0.6621 | val_acc=0.4663 | val_macro_f1=0.2318
ceragem:  30%|###       | 3/10 [04:05<09:58, 85.47s/it]Epoch   4/10: train_loss=0.8665 | val_loss=1.5202 | train_acc=0.6825 | val_acc=0.4546 | val_macro_f1=0.2283
ceragem:  40%|####      | 4/10 [05:17<08:00, 80.16s/it]Epoch   5/10: train_loss=0.8152 | val_loss=1.6167 | train_acc=0.7058 | val_acc=0.4674 | val_macro_f1=0.2229
ceragem:  50%|#####     | 5/10 [06:33<06:31, 78.39s/it]Epoch   6/10: train_loss=0.7823 | val_loss=1.6437 | train_acc=0.7199 | val_acc=0.4422 | val_macro_f1=0.2144
ceragem:  60%|######    | 6/10 [07:49<05:11, 77.75s/it]Epoch   7/10: train_loss=0.7668 | val_loss=1.7003 | train_acc=0.7258 | val_acc=0.4417 | val_macro_f1=0.2133
ceragem:  70%|#######   | 7/10 [09:10<03:56, 78.75s/it]Epoch   8/10: train_loss=0.7414 | val_loss=1.7121 | train_acc=0.7336 | val_acc=0.4577 | val_macro_f1=0.2186
ceragem:  80%|########  | 8/10 [10:25<02:34, 77.49s/it]Epoch   9/10: train_loss=0.7271 | val_loss=1.6891 | train_acc=0.7405 | val_acc=0.4723 | val_macro_f1=0.2327
ceragem:  90%|######### | 9/10 [11:40<01:16, 76.91s/it]Epoch  10/10: train_loss=0.7108 | val_loss=1.6562 | train_acc=0.7464 | val_acc=0.4887 | val_macro_f1=0.2392
ceragem: 100%|##########| 10/10 [13:28<00:00, 86.22s/it]ceragem: 100%|##########| 10/10 [13:28<00:00, 80.80s/it]

Summary (loss: train/val, acc: train/val):
  - Epoch   1: loss 1.1563/1.2706 | acc 0.5607/0.5020 | val_macro_f1 0.2141
  - Epoch   2: loss 1.0041/1.3858 | acc 0.6256/0.4857 | val_macro_f1 0.2297
  - Epoch   3: loss 0.9173/1.4753 | acc 0.6621/0.4663 | val_macro_f1 0.2318
  - Epoch   4: loss 0.8665/1.5202 | acc 0.6825/0.4546 | val_macro_f1 0.2283
  - Epoch   5: loss 0.8152/1.6167 | acc 0.7058/0.4674 | val_macro_f1 0.2229
  - Epoch   6: loss 0.7823/1.6437 | acc 0.7199/0.4422 | val_macro_f1 0.2144
  - Epoch   7: loss 0.7668/1.7003 | acc 0.7258/0.4417 | val_macro_f1 0.2133
  - Epoch   8: loss 0.7414/1.7121 | acc 0.7336/0.4577 | val_macro_f1 0.2186
  - Epoch   9: loss 0.7271/1.6891 | acc 0.7405/0.4723 | val_macro_f1 0.2327
  - Epoch  10: loss 0.7108/1.6562 | acc 0.7464/0.4887 | val_macro_f1 0.2392

Elapsed training time: 808.04 seconds

Loaded best model from epoch 10 based on validation macro F1 0.2392.

Final validation metrics: loss=1.6562 | acc=0.4887 | macro_f1=0.2392

Validation metrics:
  Accuracy           : 0.4887
  Balanced Accuracy  : 0.2523
  Macro F1           : 0.2392
  Weighted F1        : 0.4355
  Cohen's Kappa      : 0.1240
  Matthews Corrcoef  : 0.1324

  Per-class metrics (precision | recall | f1 | support):
      W (0): 0.4264 | 0.3709 | 0.3967 | 3349
     N1 (1): 0.1758 | 0.0088 | 0.0167 | 1825
     N2 (2): 0.5511 | 0.7626 | 0.6398 | 7147
     N3 (3): 0.0303 | 0.0153 | 0.0204 | 261
      R (4): 0.1490 | 0.1039 | 0.1224 | 1463

  Confusion matrix (rows=true, cols=pred):
[[1242   26 1854    7  220]
 [ 318   16 1366   17  108]
 [1095   33 5450   77  492]
 [   7    0  202    4   48]
 [ 251   16 1017   27  152]]

  Classification report:
              precision    recall  f1-score   support

           W       0.43      0.37      0.40      3349
          N1       0.18      0.01      0.02      1825
          N2       0.55      0.76      0.64      7147
          N3       0.03      0.02      0.02       261
           R       0.15      0.10      0.12      1463

    accuracy                           0.49     14045
   macro avg       0.27      0.25      0.24     14045
weighted avg       0.42      0.49      0.44     14045


Test metrics: loss=1.7615 | acc=0.4769 | macro_f1=0.2555

Test metrics:
  Accuracy           : 0.4769
  Balanced Accuracy  : 0.2590
  Macro F1           : 0.2555
  Weighted F1        : 0.4278
  Cohen's Kappa      : 0.1035
  Matthews Corrcoef  : 0.1100

  Per-class metrics (precision | recall | f1 | support):
      W (0): 0.3976 | 0.3389 | 0.3659 | 3317
     N1 (1): 0.2696 | 0.0194 | 0.0361 | 1602
     N2 (2): 0.5422 | 0.7461 | 0.6281 | 7658
     N3 (3): 0.2159 | 0.0825 | 0.1194 | 594
      R (4): 0.1569 | 0.1082 | 0.1281 | 1728

  Confusion matrix (rows=true, cols=pred):
[[1124   35 1901   70  187]
 [ 261   31 1174    8  128]
 [1157   44 5714   86  657]
 [  48    3  461   49   33]
 [ 237    2 1288   14  187]]

  Classification report:
              precision    recall  f1-score   support

           W       0.40      0.34      0.37      3317
          N1       0.27      0.02      0.04      1602
          N2       0.54      0.75      0.63      7658
          N3       0.22      0.08      0.12       594
           R       0.16      0.11      0.13      1728

    accuracy                           0.48     14899
   macro avg       0.32      0.26      0.26     14899
weighted avg       0.42      0.48      0.43     14899



# --- Captured stdout ---
[Logging] Writing output to logs/hparam_search/20251028-055040_run009_lstm_sl20_es30_lr0.001_bs32.log
Using CUDA device 7: NVIDIA RTX A6000
Train files: 60 | Validation files: 20 | Test files: 20
Using feature columns: ['C4-M1', 'F4-M1', 'O2-M1', 'Fp1-O2', 'T3 - CZ', 'CZ - T4', 'E1', 'E2', 'ECG', 'PTAF', 'FLOW', 'ABDOMEN', 'SAO2', 'BVP', 'ACC_X', 'ACC_Y', 'ACC_Z', 'TEMP', 'EDA', 'HR', 'IBI']

preprocess-dreamt:   0%|          | 0/60 [00:00<?, ?file/s]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S025_PSG_df_updated.csv ---

preprocess-dreamt:   2%|1         | 1/60 [00:12<11:50, 12.03s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S010_PSG_df_updated.csv ---

preprocess-dreamt:   3%|3         | 2/60 [00:22<10:56, 11.32s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S013_PSG_df_updated.csv ---

preprocess-dreamt:   5%|5         | 3/60 [00:32<10:13, 10.76s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S009_PSG_df_updated.csv ---

preprocess-dreamt:   7%|6         | 4/60 [00:42<09:34, 10.26s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S051_PSG_df_updated.csv ---

preprocess-dreamt:   8%|8         | 5/60 [00:51<08:51,  9.66s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S015_PSG_df_updated.csv ---

preprocess-dreamt:  10%|#         | 6/60 [01:06<10:19, 11.47s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S003_PSG_df_updated.csv ---

preprocess-dreamt:  12%|#1        | 7/60 [01:17<10:01, 11.35s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S095_PSG_df_updated.csv ---

preprocess-dreamt:  13%|#3        | 8/60 [01:26<09:17, 10.72s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S098_PSG_df_updated.csv ---

preprocess-dreamt:  15%|#5        | 9/60 [01:37<09:15, 10.89s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S057_PSG_df_updated.csv ---

preprocess-dreamt:  17%|#6        | 10/60 [01:47<08:48, 10.57s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S018_PSG_df_updated.csv ---

preprocess-dreamt:  18%|#8        | 11/60 [02:00<09:19, 11.41s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S067_PSG_df_updated.csv ---

preprocess-dreamt:  20%|##        | 12/60 [02:10<08:44, 10.92s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S055_PSG_df_updated.csv ---

preprocess-dreamt:  22%|##1       | 13/60 [02:19<08:09, 10.41s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S044_PSG_df_updated.csv ---

preprocess-dreamt:  23%|##3       | 14/60 [02:29<07:42, 10.06s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S084_PSG_df_updated.csv ---

preprocess-dreamt:  25%|##5       | 15/60 [02:40<07:45, 10.35s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S004_PSG_df_updated.csv ---

preprocess-dreamt:  27%|##6       | 16/60 [02:51<07:52, 10.73s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S050_PSG_df_updated.csv ---

preprocess-dreamt:  28%|##8       | 17/60 [03:02<07:37, 10.63s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S091_PSG_df_updated.csv ---

preprocess-dreamt:  30%|###       | 18/60 [03:13<07:33, 10.80s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S082_PSG_df_updated.csv ---

preprocess-dreamt:  32%|###1      | 19/60 [03:23<07:11, 10.52s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S070_PSG_df_updated.csv ---

preprocess-dreamt:  33%|###3      | 20/60 [03:32<06:48, 10.21s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S021_PSG_df_updated.csv ---
Skipping file due to preprocessing error: could not convert string to float: '2.6855878538185697e-069043259327077127e-06'

preprocess-dreamt:  35%|###5      | 21/60 [05:16<24:52, 38.26s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S008_PSG_df_updated.csv ---

preprocess-dreamt:  37%|###6      | 22/60 [05:27<19:04, 30.12s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S026_PSG_df_updated.csv ---

preprocess-dreamt:  38%|###8      | 23/60 [05:41<15:32, 25.21s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S012_PSG_df_updated.csv ---

preprocess-dreamt:  40%|####      | 24/60 [05:53<12:45, 21.28s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S063_PSG_df_updated.csv ---

preprocess-dreamt:  42%|####1     | 25/60 [06:04<10:34, 18.12s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S032_PSG_df_updated.csv ---

preprocess-dreamt:  43%|####3     | 26/60 [06:21<10:03, 17.74s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S024_PSG_df_updated.csv ---

preprocess-dreamt:  45%|####5     | 27/60 [06:42<10:19, 18.77s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S031_PSG_df_updated.csv ---

preprocess-dreamt:  47%|####6     | 28/60 [07:01<10:09, 19.05s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S087_PSG_df_updated.csv ---

preprocess-dreamt:  48%|####8     | 29/60 [07:11<08:22, 16.21s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S039_PSG_df_updated.csv ---

preprocess-dreamt:  50%|#####     | 30/60 [07:23<07:27, 14.92s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S097_PSG_df_updated.csv ---

preprocess-dreamt:  52%|#####1    | 31/60 [07:34<06:40, 13.80s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S085_PSG_df_updated.csv ---

preprocess-dreamt:  53%|#####3    | 32/60 [07:46<06:06, 13.09s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S046_PSG_df_updated.csv ---

preprocess-dreamt:  55%|#####5    | 33/60 [07:58<05:46, 12.84s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S103_PSG_df_updated.csv ---

preprocess-dreamt:  57%|#####6    | 34/60 [08:10<05:27, 12.58s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S090_PSG_df_updated.csv ---

preprocess-dreamt:  58%|#####8    | 35/60 [08:22<05:09, 12.37s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S030_PSG_df_updated.csv ---

preprocess-dreamt:  60%|######    | 36/60 [08:36<05:08, 12.85s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S036_PSG_df_updated.csv ---

preprocess-dreamt:  62%|######1   | 37/60 [08:52<05:20, 13.93s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S092_PSG_df_updated.csv ---

preprocess-dreamt:  63%|######3   | 38/60 [09:06<05:05, 13.88s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S047_PSG_df_updated.csv ---

preprocess-dreamt:  65%|######5   | 39/60 [09:19<04:45, 13.61s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S016_PSG_df_updated.csv ---

preprocess-dreamt:  67%|######6   | 40/60 [09:33<04:37, 13.86s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S088_PSG_df_updated.csv ---

preprocess-dreamt:  68%|######8   | 41/60 [09:44<04:07, 13.02s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S074_PSG_df_updated.csv ---

preprocess-dreamt:  70%|#######   | 42/60 [09:55<03:44, 12.45s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S006_PSG_df_updated.csv ---

preprocess-dreamt:  72%|#######1  | 43/60 [10:06<03:24, 12.03s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S022_PSG_df_updated.csv ---

preprocess-dreamt:  73%|#######3  | 44/60 [10:18<03:10, 11.92s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S017_PSG_df_updated.csv ---

preprocess-dreamt:  75%|#######5  | 45/60 [10:33<03:13, 12.93s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S023_PSG_df_updated.csv ---

preprocess-dreamt:  77%|#######6  | 46/60 [10:45<02:56, 12.59s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S033_PSG_df_updated.csv ---

preprocess-dreamt:  78%|#######8  | 47/60 [10:57<02:39, 12.27s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S080_PSG_df_updated.csv ---

preprocess-dreamt:  80%|########  | 48/60 [11:08<02:23, 11.95s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S061_PSG_df_updated.csv ---

preprocess-dreamt:  82%|########1 | 49/60 [11:20<02:11, 11.97s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S071_PSG_df_updated.csv ---

preprocess-dreamt:  83%|########3 | 50/60 [11:31<01:57, 11.75s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S077_PSG_df_updated.csv ---

preprocess-dreamt:  85%|########5 | 51/60 [11:40<01:38, 10.91s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S053_PSG_df_updated.csv ---

preprocess-dreamt:  87%|########6 | 52/60 [11:51<01:27, 10.99s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S073_PSG_df_updated.csv ---

preprocess-dreamt:  88%|########8 | 53/60 [12:03<01:18, 11.19s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S027_PSG_df_updated.csv ---

preprocess-dreamt:  90%|######### | 54/60 [12:18<01:14, 12.34s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S102_PSG_df_updated.csv ---

preprocess-dreamt:  92%|#########1| 55/60 [12:30<01:01, 12.34s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S049_PSG_df_updated.csv ---

preprocess-dreamt:  93%|#########3| 56/60 [12:42<00:48, 12.21s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S100_PSG_df_updated.csv ---

preprocess-dreamt:  95%|#########5| 57/60 [12:56<00:38, 12.67s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S002_PSG_df_updated.csv ---

preprocess-dreamt:  97%|#########6| 58/60 [13:08<00:25, 12.54s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S076_PSG_df_updated.csv ---

preprocess-dreamt:  98%|#########8| 59/60 [13:20<00:12, 12.27s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S037_PSG_df_updated.csv ---

preprocess-dreamt: 100%|##########| 60/60 [13:33<00:00, 12.62s/file]
preprocess-dreamt: 100%|##########| 60/60 [13:33<00:00, 13.56s/file]

preprocess-dreamt:   0%|          | 0/20 [00:00<?, ?file/s]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S062_PSG_df_updated.csv ---

preprocess-dreamt:   5%|5         | 1/20 [00:07<02:17,  7.25s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S096_PSG_df_updated.csv ---

preprocess-dreamt:  10%|#         | 2/20 [00:16<02:28,  8.27s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S005_PSG_df_updated.csv ---

preprocess-dreamt:  15%|#5        | 3/20 [00:25<02:25,  8.56s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S099_PSG_df_updated.csv ---

preprocess-dreamt:  20%|##        | 4/20 [00:33<02:17,  8.59s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S059_PSG_df_updated.csv ---

preprocess-dreamt:  25%|##5       | 5/20 [00:43<02:12,  8.86s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S094_PSG_df_updated.csv ---

preprocess-dreamt:  30%|###       | 6/20 [00:52<02:07,  9.10s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S028_PSG_df_updated.csv ---

preprocess-dreamt:  35%|###5      | 7/20 [01:03<02:07,  9.81s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S043_PSG_df_updated.csv ---

preprocess-dreamt:  40%|####      | 8/20 [01:13<01:56,  9.72s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S058_PSG_df_updated.csv ---

preprocess-dreamt:  45%|####5     | 9/20 [01:23<01:47,  9.77s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S093_PSG_df_updated.csv ---

preprocess-dreamt:  50%|#####     | 10/20 [01:33<01:38,  9.89s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S079_PSG_df_updated.csv ---

preprocess-dreamt:  55%|#####5    | 11/20 [01:43<01:29,  9.95s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S075_PSG_df_updated.csv ---

preprocess-dreamt:  60%|######    | 12/20 [01:53<01:18,  9.83s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S064_PSG_df_updated.csv ---

preprocess-dreamt:  65%|######5   | 13/20 [02:03<01:09,  9.87s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S045_PSG_df_updated.csv ---

preprocess-dreamt:  70%|#######   | 14/20 [02:12<00:57,  9.60s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S011_PSG_df_updated.csv ---

preprocess-dreamt:  75%|#######5  | 15/20 [02:22<00:49,  9.92s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S086_PSG_df_updated.csv ---

preprocess-dreamt:  80%|########  | 16/20 [02:33<00:40, 10.15s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S042_PSG_df_updated.csv ---

preprocess-dreamt:  85%|########5 | 17/20 [02:41<00:28,  9.39s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S020_PSG_df_updated.csv ---
Skipping file due to preprocessing error: could not convert string to float: '-6.4942397192330.0003244678416113'

preprocess-dreamt:  90%|######### | 18/20 [02:50<00:18,  9.45s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S081_PSG_df_updated.csv ---

preprocess-dreamt:  95%|#########5| 19/20 [03:00<00:09,  9.49s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S072_PSG_df_updated.csv ---

preprocess-dreamt: 100%|##########| 20/20 [03:09<00:00,  9.43s/file]
preprocess-dreamt: 100%|##########| 20/20 [03:09<00:00,  9.48s/file]

preprocess-dreamt:   0%|          | 0/20 [00:00<?, ?file/s]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S034_PSG_df_updated.csv ---

preprocess-dreamt:   5%|5         | 1/20 [00:08<02:46,  8.74s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S083_PSG_df_updated.csv ---

preprocess-dreamt:  10%|#         | 2/20 [00:16<02:25,  8.10s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S014_PSG_df_updated.csv ---

preprocess-dreamt:  15%|#5        | 3/20 [00:26<02:30,  8.87s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S089_PSG_df_updated.csv ---

preprocess-dreamt:  20%|##        | 4/20 [00:36<02:28,  9.30s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S038_PSG_df_updated.csv ---

preprocess-dreamt:  25%|##5       | 5/20 [00:47<02:28,  9.87s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S019_PSG_df_updated.csv ---
Skipping file due to preprocessing error: could not convert string to float: '--33.0'

preprocess-dreamt:  30%|###       | 6/20 [02:23<09:10, 39.30s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S068_PSG_df_updated.csv ---

preprocess-dreamt:  35%|###5      | 7/20 [02:32<06:23, 29.53s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S029_PSG_df_updated.csv ---

preprocess-dreamt:  40%|####      | 8/20 [02:45<04:50, 24.18s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S078_PSG_df_updated.csv ---

preprocess-dreamt:  45%|####5     | 9/20 [02:55<03:37, 19.81s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S048_PSG_df_updated.csv ---

preprocess-dreamt:  50%|#####     | 10/20 [03:06<02:48, 16.85s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S065_PSG_df_updated.csv ---

preprocess-dreamt:  55%|#####5    | 11/20 [03:16<02:13, 14.86s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S040_PSG_df_updated.csv ---

preprocess-dreamt:  60%|######    | 12/20 [03:27<01:49, 13.69s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S054_PSG_df_updated.csv ---

preprocess-dreamt:  65%|######5   | 13/20 [03:38<01:29, 12.77s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S066_PSG_df_updated.csv ---

preprocess-dreamt:  70%|#######   | 14/20 [03:47<01:11, 11.87s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S069_PSG_df_updated.csv ---

preprocess-dreamt:  75%|#######5  | 15/20 [03:58<00:58, 11.66s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S035_PSG_df_updated.csv ---

preprocess-dreamt:  80%|########  | 16/20 [04:09<00:45, 11.36s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S007_PSG_df_updated.csv ---

preprocess-dreamt:  85%|########5 | 17/20 [04:19<00:32, 10.79s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S056_PSG_df_updated.csv ---

preprocess-dreamt:  90%|######### | 18/20 [04:28<00:20, 10.40s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S101_PSG_df_updated.csv ---

preprocess-dreamt:  95%|#########5| 19/20 [04:38<00:10, 10.24s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S052_PSG_df_updated.csv ---

preprocess-dreamt: 100%|##########| 20/20 [04:47<00:00,  9.99s/file]
preprocess-dreamt: 100%|##########| 20/20 [04:47<00:00, 14.39s/file]
Using 21 channels with 3000 samples per epoch.

ceragem:   0%|          | 0/10 [00:00<?, ?it/s]Epoch   1/10: train_loss=1.1563 | val_loss=1.2706 | train_acc=0.5607 | val_acc=0.5020 | val_macro_f1=0.2141

ceragem:  10%|#         | 1/10 [01:14<11:14, 74.95s/it]Epoch   2/10: train_loss=1.0041 | val_loss=1.3858 | train_acc=0.6256 | val_acc=0.4857 | val_macro_f1=0.2297

ceragem:  20%|##        | 2/10 [02:23<09:29, 71.16s/it]Epoch   3/10: train_loss=0.9173 | val_loss=1.4753 | train_acc=0.6621 | val_acc=0.4663 | val_macro_f1=0.2318

ceragem:  30%|###       | 3/10 [04:05<09:58, 85.47s/it]Epoch   4/10: train_loss=0.8665 | val_loss=1.5202 | train_acc=0.6825 | val_acc=0.4546 | val_macro_f1=0.2283

ceragem:  40%|####      | 4/10 [05:17<08:00, 80.16s/it]Epoch   5/10: train_loss=0.8152 | val_loss=1.6167 | train_acc=0.7058 | val_acc=0.4674 | val_macro_f1=0.2229

ceragem:  50%|#####     | 5/10 [06:33<06:31, 78.39s/it]Epoch   6/10: train_loss=0.7823 | val_loss=1.6437 | train_acc=0.7199 | val_acc=0.4422 | val_macro_f1=0.2144

ceragem:  60%|######    | 6/10 [07:49<05:11, 77.75s/it]Epoch   7/10: train_loss=0.7668 | val_loss=1.7003 | train_acc=0.7258 | val_acc=0.4417 | val_macro_f1=0.2133

ceragem:  70%|#######   | 7/10 [09:10<03:56, 78.75s/it]Epoch   8/10: train_loss=0.7414 | val_loss=1.7121 | train_acc=0.7336 | val_acc=0.4577 | val_macro_f1=0.2186

ceragem:  80%|########  | 8/10 [10:25<02:34, 77.49s/it]Epoch   9/10: train_loss=0.7271 | val_loss=1.6891 | train_acc=0.7405 | val_acc=0.4723 | val_macro_f1=0.2327

ceragem:  90%|######### | 9/10 [11:40<01:16, 76.91s/it]Epoch  10/10: train_loss=0.7108 | val_loss=1.6562 | train_acc=0.7464 | val_acc=0.4887 | val_macro_f1=0.2392

ceragem: 100%|##########| 10/10 [13:28<00:00, 86.22s/it]
ceragem: 100%|##########| 10/10 [13:28<00:00, 80.80s/it]

Summary (loss: train/val, acc: train/val):
  - Epoch   1: loss 1.1563/1.2706 | acc 0.5607/0.5020 | val_macro_f1 0.2141
  - Epoch   2: loss 1.0041/1.3858 | acc 0.6256/0.4857 | val_macro_f1 0.2297
  - Epoch   3: loss 0.9173/1.4753 | acc 0.6621/0.4663 | val_macro_f1 0.2318
  - Epoch   4: loss 0.8665/1.5202 | acc 0.6825/0.4546 | val_macro_f1 0.2283
  - Epoch   5: loss 0.8152/1.6167 | acc 0.7058/0.4674 | val_macro_f1 0.2229
  - Epoch   6: loss 0.7823/1.6437 | acc 0.7199/0.4422 | val_macro_f1 0.2144
  - Epoch   7: loss 0.7668/1.7003 | acc 0.7258/0.4417 | val_macro_f1 0.2133
  - Epoch   8: loss 0.7414/1.7121 | acc 0.7336/0.4577 | val_macro_f1 0.2186
  - Epoch   9: loss 0.7271/1.6891 | acc 0.7405/0.4723 | val_macro_f1 0.2327
  - Epoch  10: loss 0.7108/1.6562 | acc 0.7464/0.4887 | val_macro_f1 0.2392

Elapsed training time: 808.04 seconds

Loaded best model from epoch 10 based on validation macro F1 0.2392.

Final validation metrics: loss=1.6562 | acc=0.4887 | macro_f1=0.2392

Validation metrics:
  Accuracy           : 0.4887
  Balanced Accuracy  : 0.2523
  Macro F1           : 0.2392
  Weighted F1        : 0.4355
  Cohen's Kappa      : 0.1240
  Matthews Corrcoef  : 0.1324

  Per-class metrics (precision | recall | f1 | support):
      W (0): 0.4264 | 0.3709 | 0.3967 | 3349
     N1 (1): 0.1758 | 0.0088 | 0.0167 | 1825
     N2 (2): 0.5511 | 0.7626 | 0.6398 | 7147
     N3 (3): 0.0303 | 0.0153 | 0.0204 | 261
      R (4): 0.1490 | 0.1039 | 0.1224 | 1463

  Confusion matrix (rows=true, cols=pred):
[[1242   26 1854    7  220]
 [ 318   16 1366   17  108]
 [1095   33 5450   77  492]
 [   7    0  202    4   48]
 [ 251   16 1017   27  152]]

  Classification report:
              precision    recall  f1-score   support

           W       0.43      0.37      0.40      3349
          N1       0.18      0.01      0.02      1825
          N2       0.55      0.76      0.64      7147
          N3       0.03      0.02      0.02       261
           R       0.15      0.10      0.12      1463

    accuracy                           0.49     14045
   macro avg       0.27      0.25      0.24     14045
weighted avg       0.42      0.49      0.44     14045


Test metrics: loss=1.7615 | acc=0.4769 | macro_f1=0.2555

Test metrics:
  Accuracy           : 0.4769
  Balanced Accuracy  : 0.2590
  Macro F1           : 0.2555
  Weighted F1        : 0.4278
  Cohen's Kappa      : 0.1035
  Matthews Corrcoef  : 0.1100

  Per-class metrics (precision | recall | f1 | support):
      W (0): 0.3976 | 0.3389 | 0.3659 | 3317
     N1 (1): 0.2696 | 0.0194 | 0.0361 | 1602
     N2 (2): 0.5422 | 0.7461 | 0.6281 | 7658
     N3 (3): 0.2159 | 0.0825 | 0.1194 | 594
      R (4): 0.1569 | 0.1082 | 0.1281 | 1728

  Confusion matrix (rows=true, cols=pred):
[[1124   35 1901   70  187]
 [ 261   31 1174    8  128]
 [1157   44 5714   86  657]
 [  48    3  461   49   33]
 [ 237    2 1288   14  187]]

  Classification report:
              precision    recall  f1-score   support

           W       0.40      0.34      0.37      3317
          N1       0.27      0.02      0.04      1602
          N2       0.54      0.75      0.63      7658
          N3       0.22      0.08      0.12       594
           R       0.16      0.11      0.13      1728

    accuracy                           0.48     14899
   macro avg       0.32      0.26      0.26     14899
weighted avg       0.42      0.48      0.43     14899

