[Logging] Writing output to logs/20251027-224454_lstm.log
Using CUDA device 7: NVIDIA RTX A6000
Train files: 60 | Validation files: 20 | Test files: 20
Using feature columns: ['C4-M1', 'F4-M1', 'O2-M1', 'Fp1-O2', 'T3 - CZ', 'CZ - T4', 'E1', 'E2', 'ECG', 'PTAF', 'FLOW', 'ABDOMEN', 'SAO2', 'BVP', 'ACC_X', 'ACC_Y', 'ACC_Z', 'TEMP', 'EDA', 'HR', 'IBI']
preprocess-dreamt:   0%|          | 0/60 [00:00<?, ?file/s]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S025_PSG_df_updated.csv ---
preprocess-dreamt:   2%|1         | 1/60 [00:10<09:55, 10.10s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S010_PSG_df_updated.csv ---
preprocess-dreamt:   3%|3         | 2/60 [00:19<09:22,  9.70s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S013_PSG_df_updated.csv ---
preprocess-dreamt:   5%|5         | 3/60 [00:27<08:36,  9.06s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S009_PSG_df_updated.csv ---
preprocess-dreamt:   7%|6         | 4/60 [00:36<08:21,  8.96s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S051_PSG_df_updated.csv ---
preprocess-dreamt:   8%|8         | 5/60 [00:44<07:53,  8.61s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S015_PSG_df_updated.csv ---
preprocess-dreamt:  10%|#         | 6/60 [00:56<08:51,  9.83s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S003_PSG_df_updated.csv ---
preprocess-dreamt:  12%|#1        | 7/60 [01:05<08:24,  9.52s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S095_PSG_df_updated.csv ---
preprocess-dreamt:  13%|#3        | 8/60 [01:14<07:57,  9.19s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S098_PSG_df_updated.csv ---
preprocess-dreamt:  15%|#5        | 9/60 [01:22<07:39,  9.01s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S057_PSG_df_updated.csv ---
preprocess-dreamt:  17%|#6        | 10/60 [01:31<07:31,  9.03s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S018_PSG_df_updated.csv ---
preprocess-dreamt:  18%|#8        | 11/60 [01:46<08:44, 10.70s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S067_PSG_df_updated.csv ---
preprocess-dreamt:  20%|##        | 12/60 [01:55<08:10, 10.21s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S055_PSG_df_updated.csv ---
preprocess-dreamt:  22%|##1       | 13/60 [02:04<07:41,  9.83s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S044_PSG_df_updated.csv ---
preprocess-dreamt:  23%|##3       | 14/60 [02:11<06:59,  9.13s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S084_PSG_df_updated.csv ---
preprocess-dreamt:  25%|##5       | 15/60 [02:20<06:48,  9.09s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S004_PSG_df_updated.csv ---
preprocess-dreamt:  27%|##6       | 16/60 [02:29<06:36,  9.02s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S050_PSG_df_updated.csv ---
preprocess-dreamt:  28%|##8       | 17/60 [02:37<06:14,  8.71s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S091_PSG_df_updated.csv ---
preprocess-dreamt:  30%|###       | 18/60 [02:47<06:13,  8.88s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S082_PSG_df_updated.csv ---
preprocess-dreamt:  32%|###1      | 19/60 [02:55<06:03,  8.87s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S070_PSG_df_updated.csv ---
preprocess-dreamt:  33%|###3      | 20/60 [03:04<05:49,  8.73s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S021_PSG_df_updated.csv ---
Skipping file due to preprocessing error: could not convert string to float: '1.416037-06'
preprocess-dreamt:  35%|###5      | 21/60 [04:42<23:13, 35.73s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S008_PSG_df_updated.csv ---
preprocess-dreamt:  37%|###6      | 22/60 [04:52<17:36, 27.81s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S026_PSG_df_updated.csv ---
preprocess-dreamt:  38%|###8      | 23/60 [05:03<14:03, 22.81s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S012_PSG_df_updated.csv ---
preprocess-dreamt:  40%|####      | 24/60 [05:13<11:28, 19.13s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S063_PSG_df_updated.csv ---
preprocess-dreamt:  42%|####1     | 25/60 [05:22<09:20, 16.00s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S032_PSG_df_updated.csv ---
preprocess-dreamt:  43%|####3     | 26/60 [05:32<08:01, 14.17s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S024_PSG_df_updated.csv ---
preprocess-dreamt:  45%|####5     | 27/60 [05:43<07:10, 13.06s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S031_PSG_df_updated.csv ---
preprocess-dreamt:  47%|####6     | 28/60 [05:51<06:16, 11.78s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S087_PSG_df_updated.csv ---
preprocess-dreamt:  48%|####8     | 29/60 [06:00<05:36, 10.85s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S039_PSG_df_updated.csv ---
preprocess-dreamt:  50%|#####     | 30/60 [06:09<05:13, 10.44s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S097_PSG_df_updated.csv ---
preprocess-dreamt:  52%|#####1    | 31/60 [06:17<04:36,  9.55s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S085_PSG_df_updated.csv ---
preprocess-dreamt:  53%|#####3    | 32/60 [06:26<04:22,  9.38s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S046_PSG_df_updated.csv ---
preprocess-dreamt:  55%|#####5    | 33/60 [06:36<04:15,  9.48s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S103_PSG_df_updated.csv ---
preprocess-dreamt:  57%|#####6    | 34/60 [06:44<03:54,  9.03s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S090_PSG_df_updated.csv ---
preprocess-dreamt:  58%|#####8    | 35/60 [06:53<03:48,  9.15s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S030_PSG_df_updated.csv ---
preprocess-dreamt:  60%|######    | 36/60 [07:04<03:49,  9.55s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S036_PSG_df_updated.csv ---
preprocess-dreamt:  62%|######1   | 37/60 [07:15<03:53, 10.16s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S092_PSG_df_updated.csv ---
preprocess-dreamt:  63%|######3   | 38/60 [07:24<03:37,  9.87s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S047_PSG_df_updated.csv ---
preprocess-dreamt:  65%|######5   | 39/60 [07:33<03:20,  9.57s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S016_PSG_df_updated.csv ---
preprocess-dreamt:  67%|######6   | 40/60 [07:45<03:23, 10.18s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S088_PSG_df_updated.csv ---
preprocess-dreamt:  68%|######8   | 41/60 [07:55<03:11, 10.06s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S074_PSG_df_updated.csv ---
preprocess-dreamt:  70%|#######   | 42/60 [08:04<02:57,  9.87s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S006_PSG_df_updated.csv ---
preprocess-dreamt:  72%|#######1  | 43/60 [08:14<02:49,  9.96s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S022_PSG_df_updated.csv ---
preprocess-dreamt:  73%|#######3  | 44/60 [08:26<02:46, 10.42s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S017_PSG_df_updated.csv ---
preprocess-dreamt:  75%|#######5  | 45/60 [08:39<02:49, 11.30s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S023_PSG_df_updated.csv ---
preprocess-dreamt:  77%|#######6  | 46/60 [08:49<02:32, 10.92s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S033_PSG_df_updated.csv ---
preprocess-dreamt:  78%|#######8  | 47/60 [08:59<02:17, 10.55s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S080_PSG_df_updated.csv ---
preprocess-dreamt:  80%|########  | 48/60 [09:08<02:02, 10.20s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S061_PSG_df_updated.csv ---
preprocess-dreamt:  82%|########1 | 49/60 [09:18<01:50, 10.03s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S071_PSG_df_updated.csv ---
preprocess-dreamt:  83%|########3 | 50/60 [09:27<01:37,  9.79s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S077_PSG_df_updated.csv ---
preprocess-dreamt:  85%|########5 | 51/60 [09:34<01:21,  9.08s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S053_PSG_df_updated.csv ---
preprocess-dreamt:  87%|########6 | 52/60 [09:43<01:12,  9.04s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S073_PSG_df_updated.csv ---
preprocess-dreamt:  88%|########8 | 53/60 [09:53<01:04,  9.25s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S027_PSG_df_updated.csv ---
preprocess-dreamt:  90%|######### | 54/60 [10:03<00:57,  9.59s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S102_PSG_df_updated.csv ---
preprocess-dreamt:  92%|#########1| 55/60 [10:12<00:46,  9.30s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S049_PSG_df_updated.csv ---
preprocess-dreamt:  93%|#########3| 56/60 [10:22<00:37,  9.43s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S100_PSG_df_updated.csv ---
preprocess-dreamt:  95%|#########5| 57/60 [10:31<00:28,  9.39s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S002_PSG_df_updated.csv ---
preprocess-dreamt:  97%|#########6| 58/60 [10:40<00:18,  9.37s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S076_PSG_df_updated.csv ---
preprocess-dreamt:  98%|#########8| 59/60 [10:50<00:09,  9.42s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S037_PSG_df_updated.csv ---
preprocess-dreamt: 100%|##########| 60/60 [11:02<00:00, 10.35s/file]preprocess-dreamt: 100%|##########| 60/60 [11:02<00:00, 11.05s/file]
preprocess-dreamt:   0%|          | 0/20 [00:00<?, ?file/s]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S062_PSG_df_updated.csv ---
preprocess-dreamt:   5%|5         | 1/20 [00:07<02:18,  7.30s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S096_PSG_df_updated.csv ---
preprocess-dreamt:  10%|#         | 2/20 [00:16<02:36,  8.70s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S005_PSG_df_updated.csv ---
preprocess-dreamt:  15%|#5        | 3/20 [00:27<02:40,  9.41s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S099_PSG_df_updated.csv ---
preprocess-dreamt:  20%|##        | 4/20 [00:38<02:41, 10.08s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S059_PSG_df_updated.csv ---
preprocess-dreamt:  25%|##5       | 5/20 [00:50<02:40, 10.72s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S094_PSG_df_updated.csv ---
preprocess-dreamt:  30%|###       | 6/20 [01:01<02:30, 10.77s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S028_PSG_df_updated.csv ---
preprocess-dreamt:  35%|###5      | 7/20 [01:15<02:34, 11.87s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S043_PSG_df_updated.csv ---
preprocess-dreamt:  40%|####      | 8/20 [01:26<02:20, 11.69s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S058_PSG_df_updated.csv ---
preprocess-dreamt:  45%|####5     | 9/20 [01:38<02:09, 11.81s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S093_PSG_df_updated.csv ---
preprocess-dreamt:  50%|#####     | 10/20 [01:49<01:54, 11.48s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S079_PSG_df_updated.csv ---
preprocess-dreamt:  55%|#####5    | 11/20 [01:59<01:40, 11.12s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S075_PSG_df_updated.csv ---
preprocess-dreamt:  60%|######    | 12/20 [02:10<01:27, 10.96s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S064_PSG_df_updated.csv ---
preprocess-dreamt:  65%|######5   | 13/20 [02:22<01:20, 11.48s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S045_PSG_df_updated.csv ---
preprocess-dreamt:  70%|#######   | 14/20 [02:33<01:07, 11.33s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S011_PSG_df_updated.csv ---
preprocess-dreamt:  75%|#######5  | 15/20 [02:45<00:57, 11.48s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S086_PSG_df_updated.csv ---
preprocess-dreamt:  80%|########  | 16/20 [02:56<00:45, 11.40s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S042_PSG_df_updated.csv ---
preprocess-dreamt:  85%|########5 | 17/20 [03:05<00:32, 10.67s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S020_PSG_df_updated.csv ---
Skipping file due to preprocessing error: could not convert string to float: '-6.4942397192330.0003244678416113'
preprocess-dreamt:  90%|######### | 18/20 [03:16<00:21, 10.51s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S081_PSG_df_updated.csv ---
preprocess-dreamt:  95%|#########5| 19/20 [03:25<00:10, 10.32s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S072_PSG_df_updated.csv ---
preprocess-dreamt: 100%|##########| 20/20 [03:37<00:00, 10.58s/file]preprocess-dreamt: 100%|##########| 20/20 [03:37<00:00, 10.86s/file]
preprocess-dreamt:   0%|          | 0/20 [00:00<?, ?file/s]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S034_PSG_df_updated.csv ---
preprocess-dreamt:   5%|5         | 1/20 [00:09<02:56,  9.28s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S083_PSG_df_updated.csv ---
preprocess-dreamt:  10%|#         | 2/20 [00:16<02:29,  8.32s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S014_PSG_df_updated.csv ---
preprocess-dreamt:  15%|#5        | 3/20 [00:26<02:32,  9.00s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S089_PSG_df_updated.csv ---
preprocess-dreamt:  20%|##        | 4/20 [00:37<02:33,  9.59s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S038_PSG_df_updated.csv ---
preprocess-dreamt:  25%|##5       | 5/20 [00:49<02:35, 10.38s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S019_PSG_df_updated.csv ---
Skipping file due to preprocessing error: could not convert string to float: '1.6-06'
preprocess-dreamt:  30%|###       | 6/20 [02:24<09:08, 39.20s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S068_PSG_df_updated.csv ---
preprocess-dreamt:  35%|###5      | 7/20 [02:35<06:33, 30.24s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S029_PSG_df_updated.csv ---
preprocess-dreamt:  40%|####      | 8/20 [02:47<04:51, 24.29s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S078_PSG_df_updated.csv ---
preprocess-dreamt:  45%|####5     | 9/20 [02:56<03:35, 19.58s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S048_PSG_df_updated.csv ---
preprocess-dreamt:  50%|#####     | 10/20 [03:05<02:43, 16.35s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S065_PSG_df_updated.csv ---
preprocess-dreamt:  55%|#####5    | 11/20 [03:15<02:07, 14.20s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S040_PSG_df_updated.csv ---
preprocess-dreamt:  60%|######    | 12/20 [03:25<01:44, 13.06s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S054_PSG_df_updated.csv ---
preprocess-dreamt:  65%|######5   | 13/20 [03:35<01:23, 12.00s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S066_PSG_df_updated.csv ---
preprocess-dreamt:  70%|#######   | 14/20 [03:44<01:06, 11.07s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S069_PSG_df_updated.csv ---
preprocess-dreamt:  75%|#######5  | 15/20 [03:54<00:53, 10.73s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S035_PSG_df_updated.csv ---
preprocess-dreamt:  80%|########  | 16/20 [04:04<00:42, 10.53s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S007_PSG_df_updated.csv ---
preprocess-dreamt:  85%|########5 | 17/20 [04:12<00:30, 10.00s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S056_PSG_df_updated.csv ---
preprocess-dreamt:  90%|######### | 18/20 [04:21<00:19,  9.65s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S101_PSG_df_updated.csv ---
preprocess-dreamt:  95%|#########5| 19/20 [04:31<00:09,  9.57s/file]
--- Processing file: /data/ceragem/physionet.org/files/dreamt/2.1.0/data_100Hz/S052_PSG_df_updated.csv ---
preprocess-dreamt: 100%|##########| 20/20 [04:39<00:00,  9.27s/file]preprocess-dreamt: 100%|##########| 20/20 [04:39<00:00, 13.98s/file]
Using 21 channels with 3000 samples per epoch.
ceragem:   0%|          | 0/10 [00:00<?, ?it/s]Epoch   1/10: train_loss=1.0757 | val_loss=1.0922 | train_acc=0.6032 | val_acc=0.6042 | val_macro_f1=0.3087
ceragem:  10%|#         | 1/10 [00:30<04:30, 30.04s/it]Epoch   2/10: train_loss=1.0285 | val_loss=1.1851 | train_acc=0.6172 | val_acc=0.5783 | val_macro_f1=0.2907
ceragem:  20%|##        | 2/10 [00:59<03:55, 29.41s/it]Epoch   3/10: train_loss=1.0137 | val_loss=1.1072 | train_acc=0.6197 | val_acc=0.6079 | val_macro_f1=0.3131
ceragem:  30%|###       | 3/10 [01:27<03:21, 28.81s/it]Epoch   4/10: train_loss=1.0113 | val_loss=1.0933 | train_acc=0.6231 | val_acc=0.6139 | val_macro_f1=0.3201
ceragem:  40%|####      | 4/10 [01:55<02:51, 28.59s/it]Epoch   5/10: train_loss=1.0143 | val_loss=1.0984 | train_acc=0.6217 | val_acc=0.6062 | val_macro_f1=0.3076
ceragem:  50%|#####     | 5/10 [02:22<02:20, 28.01s/it]Epoch   6/10: train_loss=1.0095 | val_loss=1.1170 | train_acc=0.6225 | val_acc=0.5947 | val_macro_f1=0.2966
ceragem:  60%|######    | 6/10 [02:53<01:55, 28.97s/it]Epoch   7/10: train_loss=1.0049 | val_loss=1.1847 | train_acc=0.6258 | val_acc=0.5913 | val_macro_f1=0.3021
ceragem:  70%|#######   | 7/10 [03:22<01:27, 29.17s/it]Epoch   8/10: train_loss=1.0035 | val_loss=1.1255 | train_acc=0.6264 | val_acc=0.6016 | val_macro_f1=0.3028
ceragem:  80%|########  | 8/10 [03:52<00:58, 29.32s/it]Epoch   9/10: train_loss=1.0009 | val_loss=1.1190 | train_acc=0.6253 | val_acc=0.5966 | val_macro_f1=0.3096
ceragem:  90%|######### | 9/10 [04:20<00:29, 29.06s/it]Epoch  10/10: train_loss=0.9993 | val_loss=1.0996 | train_acc=0.6285 | val_acc=0.6056 | val_macro_f1=0.3057
ceragem: 100%|##########| 10/10 [04:49<00:00, 29.01s/it]ceragem: 100%|##########| 10/10 [04:49<00:00, 28.98s/it]

Summary (loss: train/val, acc: train/val):
  - Epoch   1: loss 1.0757/1.0922 | acc 0.6032/0.6042 | val_macro_f1 0.3087
  - Epoch   2: loss 1.0285/1.1851 | acc 0.6172/0.5783 | val_macro_f1 0.2907
  - Epoch   3: loss 1.0137/1.1072 | acc 0.6197/0.6079 | val_macro_f1 0.3131
  - Epoch   4: loss 1.0113/1.0933 | acc 0.6231/0.6139 | val_macro_f1 0.3201
  - Epoch   5: loss 1.0143/1.0984 | acc 0.6217/0.6062 | val_macro_f1 0.3076
  - Epoch   6: loss 1.0095/1.1170 | acc 0.6225/0.5947 | val_macro_f1 0.2966
  - Epoch   7: loss 1.0049/1.1847 | acc 0.6258/0.5913 | val_macro_f1 0.3021
  - Epoch   8: loss 1.0035/1.1255 | acc 0.6264/0.6016 | val_macro_f1 0.3028
  - Epoch   9: loss 1.0009/1.1190 | acc 0.6253/0.5966 | val_macro_f1 0.3096
  - Epoch  10: loss 0.9993/1.0996 | acc 0.6285/0.6056 | val_macro_f1 0.3057

Elapsed training time: 289.77 seconds

Loaded best model from epoch 4 based on validation macro F1 0.3201.

Final validation metrics: loss=1.0933 | acc=0.6139 | macro_f1=0.3201

Validation metrics:
  Accuracy           : 0.6139
  Balanced Accuracy  : 0.3499
  Macro F1           : 0.3201
  Weighted F1        : 0.5264
  Cohen's Kappa      : 0.4181
  Matthews Corrcoef  : 0.4777

  Per-class metrics (precision | recall | f1 | support):
      W (0): 0.5511 | 0.2037 | 0.2975 | 3627
      P (1): 0.9407 | 0.9532 | 0.9469 | 3996
     N1 (2): 0.0000 | 0.0000 | 0.0000 | 1857
     N2 (3): 0.5216 | 0.9388 | 0.6706 | 7170
     N3 (4): 0.0123 | 0.0038 | 0.0058 | 262
      R (5): 0.0000 | 0.0000 | 0.0000 | 1463

  Confusion matrix (rows=true, cols=pred):
[[ 739  116    0 2761   11    0]
 [  59 3809    0  128    0    0]
 [ 116    6    0 1726    9    0]
 [ 285  110    0 6731   44    0]
 [   1    3    0  257    1    0]
 [ 141    5    0 1301   16    0]]

  Classification report:
              precision    recall  f1-score   support

           W       0.55      0.20      0.30      3627
           P       0.94      0.95      0.95      3996
          N1       0.00      0.00      0.00      1857
          N2       0.52      0.94      0.67      7170
          N3       0.01      0.00      0.01       262
           R       0.00      0.00      0.00      1463

    accuracy                           0.61     18375
   macro avg       0.34      0.35      0.32     18375
weighted avg       0.52      0.61      0.53     18375


Test metrics: loss=1.0885 | acc=0.6095 | macro_f1=0.3238

Test metrics:
  Accuracy           : 0.6095
  Balanced Accuracy  : 0.3479
  Macro F1           : 0.3238
  Weighted F1        : 0.5292
  Cohen's Kappa      : 0.4115
  Matthews Corrcoef  : 0.4621

  Per-class metrics (precision | recall | f1 | support):
      W (0): 0.4470 | 0.2468 | 0.3180 | 3639
      P (1): 0.9703 | 0.9019 | 0.9348 | 4270
     N1 (2): 0.0000 | 0.0000 | 0.0000 | 1612
     N2 (3): 0.5279 | 0.9302 | 0.6735 | 7683
     N3 (4): 0.5556 | 0.0084 | 0.0166 | 594
      R (5): 0.0000 | 0.0000 | 0.0000 | 1728

  Confusion matrix (rows=true, cols=pred):
[[ 898   74    0 2667    0    0]
 [ 351 3851    0   68    0    0]
 [ 129    9    0 1473    1    0]
 [ 498   35    0 7147    3    0]
 [  30    0    0  559    5    0]
 [ 103    0    0 1625    0    0]]

  Classification report:
              precision    recall  f1-score   support

           W       0.45      0.25      0.32      3639
           P       0.97      0.90      0.93      4270
          N1       0.00      0.00      0.00      1612
          N2       0.53      0.93      0.67      7683
          N3       0.56      0.01      0.02       594
           R       0.00      0.00      0.00      1728

    accuracy                           0.61     19526
   macro avg       0.42      0.35      0.32     19526
weighted avg       0.52      0.61      0.53     19526

